{"ast":null,"code":"/*! @azure/msal-common v13.0.0 2023-05-01 */\n'use strict';\n\nimport { AUTHORITY_METADATA_CONSTANTS } from '../../utils/Constants.js';\nimport { TimeUtils } from '../../utils/TimeUtils.js';\n\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\nvar AuthorityMetadataEntity = /** @class */function () {\n  function AuthorityMetadataEntity() {\n    this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n  }\n  /**\r\n   * Update the entity with new aliases, preferred_cache and preferred_network values\r\n   * @param metadata\r\n   * @param fromNetwork\r\n   */\n  AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata = function (metadata, fromNetwork) {\n    this.aliases = metadata.aliases;\n    this.preferred_cache = metadata.preferred_cache;\n    this.preferred_network = metadata.preferred_network;\n    this.aliasesFromNetwork = fromNetwork;\n  };\n  /**\r\n   * Update the entity with new endpoints\r\n   * @param metadata\r\n   * @param fromNetwork\r\n   */\n  AuthorityMetadataEntity.prototype.updateEndpointMetadata = function (metadata, fromNetwork) {\n    this.authorization_endpoint = metadata.authorization_endpoint;\n    this.token_endpoint = metadata.token_endpoint;\n    this.end_session_endpoint = metadata.end_session_endpoint;\n    this.issuer = metadata.issuer;\n    this.endpointsFromNetwork = fromNetwork;\n    this.jwks_uri = metadata.jwks_uri;\n  };\n  /**\r\n   * Save the authority that was used to create this cache entry\r\n   * @param authority\r\n   */\n  AuthorityMetadataEntity.prototype.updateCanonicalAuthority = function (authority) {\n    this.canonical_authority = authority;\n  };\n  /**\r\n   * Reset the exiresAt value\r\n   */\n  AuthorityMetadataEntity.prototype.resetExpiresAt = function () {\n    this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n  };\n  /**\r\n   * Returns whether or not the data needs to be refreshed\r\n   */\n  AuthorityMetadataEntity.prototype.isExpired = function () {\n    return this.expiresAt <= TimeUtils.nowSeconds();\n  };\n  /**\r\n   * Validates an entity: checks for all expected params\r\n   * @param entity\r\n   */\n  AuthorityMetadataEntity.isAuthorityMetadataEntity = function (key, entity) {\n    if (!entity) {\n      return false;\n    }\n    return key.indexOf(AUTHORITY_METADATA_CONSTANTS.CACHE_KEY) === 0 && entity.hasOwnProperty(\"aliases\") && entity.hasOwnProperty(\"preferred_cache\") && entity.hasOwnProperty(\"preferred_network\") && entity.hasOwnProperty(\"canonical_authority\") && entity.hasOwnProperty(\"authorization_endpoint\") && entity.hasOwnProperty(\"token_endpoint\") && entity.hasOwnProperty(\"issuer\") && entity.hasOwnProperty(\"aliasesFromNetwork\") && entity.hasOwnProperty(\"endpointsFromNetwork\") && entity.hasOwnProperty(\"expiresAt\") && entity.hasOwnProperty(\"jwks_uri\");\n  };\n  return AuthorityMetadataEntity;\n}();\nexport { AuthorityMetadataEntity };","map":{"version":3,"names":["AuthorityMetadataEntity","expiresAt","TimeUtils","nowSeconds","AUTHORITY_METADATA_CONSTANTS","REFRESH_TIME_SECONDS","prototype","updateCloudDiscoveryMetadata","metadata","fromNetwork","aliases","preferred_cache","preferred_network","aliasesFromNetwork","updateEndpointMetadata","authorization_endpoint","token_endpoint","end_session_endpoint","issuer","endpointsFromNetwork","jwks_uri","updateCanonicalAuthority","authority","canonical_authority","resetExpiresAt","isExpired","isAuthorityMetadataEntity","key","entity","indexOf","CACHE_KEY","hasOwnProperty"],"sources":["../../../src/cache/entities/AuthorityMetadataEntity.ts"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { CloudDiscoveryMetadata } from \"../../authority/CloudDiscoveryMetadata\";\nimport { OpenIdConfigResponse } from \"../../authority/OpenIdConfigResponse\";\nimport { AUTHORITY_METADATA_CONSTANTS } from \"../../utils/Constants\";\nimport { TimeUtils } from \"../../utils/TimeUtils\";\n\nexport class AuthorityMetadataEntity {\n    aliases: Array<string>;\n    preferred_cache: string;\n    preferred_network: string;\n    canonical_authority: string;\n    authorization_endpoint: string;\n    token_endpoint: string;\n    end_session_endpoint?: string;\n    issuer: string;\n    aliasesFromNetwork: boolean;\n    endpointsFromNetwork: boolean;\n    expiresAt: number;\n    jwks_uri: string;\n\n    constructor() {\n        this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n    }\n\n    /**\n     * Update the entity with new aliases, preferred_cache and preferred_network values\n     * @param metadata \n     * @param fromNetwork \n     */\n    updateCloudDiscoveryMetadata(metadata: CloudDiscoveryMetadata, fromNetwork: boolean): void {\n        this.aliases = metadata.aliases;\n        this.preferred_cache = metadata.preferred_cache;\n        this.preferred_network = metadata.preferred_network;\n        this.aliasesFromNetwork = fromNetwork;\n    }\n\n    /**\n     * Update the entity with new endpoints\n     * @param metadata \n     * @param fromNetwork \n     */\n    updateEndpointMetadata(metadata: OpenIdConfigResponse, fromNetwork: boolean): void {\n        this.authorization_endpoint = metadata.authorization_endpoint;\n        this.token_endpoint = metadata.token_endpoint;\n        this.end_session_endpoint = metadata.end_session_endpoint;\n        this.issuer = metadata.issuer;\n        this.endpointsFromNetwork = fromNetwork;\n        this.jwks_uri = metadata.jwks_uri;\n    }\n\n    /**\n     * Save the authority that was used to create this cache entry\n     * @param authority \n     */\n    updateCanonicalAuthority(authority: string): void {\n        this.canonical_authority = authority;\n    }\n\n    /**\n     * Reset the exiresAt value\n     */\n    resetExpiresAt(): void {\n        this.expiresAt = TimeUtils.nowSeconds() + AUTHORITY_METADATA_CONSTANTS.REFRESH_TIME_SECONDS;\n    }\n\n    /**\n     * Returns whether or not the data needs to be refreshed\n     */\n    isExpired(): boolean {\n        return this.expiresAt <= TimeUtils.nowSeconds();\n    }\n\n    /**\n     * Validates an entity: checks for all expected params\n     * @param entity\n     */\n    static isAuthorityMetadataEntity(key: string, entity: object): boolean {\n\n        if (!entity) {\n            return false;\n        }\n\n        return (\n            key.indexOf(AUTHORITY_METADATA_CONSTANTS.CACHE_KEY) === 0 &&\n            entity.hasOwnProperty(\"aliases\") &&\n            entity.hasOwnProperty(\"preferred_cache\") &&\n            entity.hasOwnProperty(\"preferred_network\") &&\n            entity.hasOwnProperty(\"canonical_authority\") &&\n            entity.hasOwnProperty(\"authorization_endpoint\") &&\n            entity.hasOwnProperty(\"token_endpoint\") &&\n            entity.hasOwnProperty(\"issuer\") &&\n            entity.hasOwnProperty(\"aliasesFromNetwork\") &&\n            entity.hasOwnProperty(\"endpointsFromNetwork\") &&\n            entity.hasOwnProperty(\"expiresAt\") &&\n            entity.hasOwnProperty(\"jwks_uri\")\n        );\n    }\n}\n"],"mappings":";;;;;;AAAA;;;AAGG;AAOH,IAAAA,uBAAA;EAcI,SAAAA,wBAAA;IACI,IAAI,CAACC,SAAS,GAAGC,SAAS,CAACC,UAAU,EAAE,GAAGC,4BAA4B,CAACC,oBAAoB;;EAG/F;;;;AAIG;EACHL,uBAAA,CAAAM,SAAA,CAAAC,4BAA4B,GAA5B,UAA6BC,QAAgC,EAAEC,WAAoB;IAC/E,IAAI,CAACC,OAAO,GAAGF,QAAQ,CAACE,OAAO;IAC/B,IAAI,CAACC,eAAe,GAAGH,QAAQ,CAACG,eAAe;IAC/C,IAAI,CAACC,iBAAiB,GAAGJ,QAAQ,CAACI,iBAAiB;IACnD,IAAI,CAACC,kBAAkB,GAAGJ,WAAW;GACxC;EAED;;;;AAIG;EACHT,uBAAA,CAAAM,SAAA,CAAAQ,sBAAsB,GAAtB,UAAuBN,QAA8B,EAAEC,WAAoB;IACvE,IAAI,CAACM,sBAAsB,GAAGP,QAAQ,CAACO,sBAAsB;IAC7D,IAAI,CAACC,cAAc,GAAGR,QAAQ,CAACQ,cAAc;IAC7C,IAAI,CAACC,oBAAoB,GAAGT,QAAQ,CAACS,oBAAoB;IACzD,IAAI,CAACC,MAAM,GAAGV,QAAQ,CAACU,MAAM;IAC7B,IAAI,CAACC,oBAAoB,GAAGV,WAAW;IACvC,IAAI,CAACW,QAAQ,GAAGZ,QAAQ,CAACY,QAAQ;GACpC;EAED;;;AAGG;EACHpB,uBAAwB,CAAAM,SAAA,CAAAe,wBAAA,GAAxB,UAAyBC,SAAiB;IACtC,IAAI,CAACC,mBAAmB,GAAGD,SAAS;GACvC;EAED;;AAEG;EACHtB,uBAAA,CAAAM,SAAA,CAAAkB,cAAc,GAAd;IACI,IAAI,CAACvB,SAAS,GAAGC,SAAS,CAACC,UAAU,EAAE,GAAGC,4BAA4B,CAACC,oBAAoB;GAC9F;EAED;;AAEG;EACHL,uBAAA,CAAAM,SAAA,CAAAmB,SAAS,GAAT;IACI,OAAO,IAAI,CAACxB,SAAS,IAAIC,SAAS,CAACC,UAAU,EAAE;GAClD;EAED;;;AAGG;EACIH,uBAAA,CAAA0B,yBAAyB,GAAhC,UAAiCC,GAAW,EAAEC,MAAc;IAExD,IAAI,CAACA,MAAM,EAAE;MACT,OAAO,KAAK;IACf;IAED,OACID,GAAG,CAACE,OAAO,CAACzB,4BAA4B,CAAC0B,SAAS,CAAC,KAAK,CAAC,IACzDF,MAAM,CAACG,cAAc,CAAC,SAAS,CAAC,IAChCH,MAAM,CAACG,cAAc,CAAC,iBAAiB,CAAC,IACxCH,MAAM,CAACG,cAAc,CAAC,mBAAmB,CAAC,IAC1CH,MAAM,CAACG,cAAc,CAAC,qBAAqB,CAAC,IAC5CH,MAAM,CAACG,cAAc,CAAC,wBAAwB,CAAC,IAC/CH,MAAM,CAACG,cAAc,CAAC,gBAAgB,CAAC,IACvCH,MAAM,CAACG,cAAc,CAAC,QAAQ,CAAC,IAC/BH,MAAM,CAACG,cAAc,CAAC,oBAAoB,CAAC,IAC3CH,MAAM,CAACG,cAAc,CAAC,sBAAsB,CAAC,IAC7CH,MAAM,CAACG,cAAc,CAAC,WAAW,CAAC,IAClCH,MAAM,CAACG,cAAc,CAAC,UAAU,CAAC;GAExC;EACL,OAAC/B,uBAAA;AAAD,CAAC"},"metadata":{},"sourceType":"module"}