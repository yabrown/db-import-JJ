{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _token = require(\"./token\");\nfunction parseChallenge(buffer) {\n  var challenge = {};\n  challenge.magic = buffer.slice(0, 8).toString('utf8');\n  challenge.type = buffer.readInt32LE(8);\n  challenge.domainLen = buffer.readInt16LE(12);\n  challenge.domainMax = buffer.readInt16LE(14);\n  challenge.domainOffset = buffer.readInt32LE(16);\n  challenge.flags = buffer.readInt32LE(20);\n  challenge.nonce = buffer.slice(24, 32);\n  challenge.zeroes = buffer.slice(32, 40);\n  challenge.targetLen = buffer.readInt16LE(40);\n  challenge.targetMax = buffer.readInt16LE(42);\n  challenge.targetOffset = buffer.readInt32LE(44);\n  challenge.oddData = buffer.slice(48, 56);\n  challenge.domain = buffer.slice(56, 56 + challenge.domainLen).toString('ucs2');\n  challenge.target = buffer.slice(56 + challenge.domainLen, 56 + challenge.domainLen + challenge.targetLen);\n  return challenge;\n}\nfunction sspiParser(parser, _options, callback) {\n  parser.readUsVarByte(function (buffer) {\n    callback(new _token.SSPIToken(parseChallenge(buffer), buffer));\n  });\n}\nvar _default = sspiParser;\nexports.default = _default;\nmodule.exports = sspiParser;","map":{"version":3,"names":["_token","require","parseChallenge","buffer","challenge","magic","slice","toString","type","readInt32LE","domainLen","readInt16LE","domainMax","domainOffset","flags","nonce","zeroes","targetLen","targetMax","targetOffset","oddData","domain","target","sspiParser","parser","_options","callback","readUsVarByte","SSPIToken","module","exports"],"sources":["../../src/token/sspi-token-parser.ts"],"sourcesContent":["import Parser, { ParserOptions } from './stream-parser';\n\nimport { SSPIToken } from './token';\n\ninterface Data {\n  magic: string;\n  type: number;\n  domainLen: number;\n  domainMax: number;\n  domainOffset: number;\n  flags: number;\n  nonce: Buffer;\n  zeroes: Buffer;\n  targetLen: number;\n  targetMax: number;\n  targetOffset: number;\n  oddData: Buffer;\n  domain: string;\n  target: Buffer;\n}\n\nfunction parseChallenge(buffer: Buffer) {\n  const challenge: Partial<Data> = {};\n\n  challenge.magic = buffer.slice(0, 8).toString('utf8');\n  challenge.type = buffer.readInt32LE(8);\n  challenge.domainLen = buffer.readInt16LE(12);\n  challenge.domainMax = buffer.readInt16LE(14);\n  challenge.domainOffset = buffer.readInt32LE(16);\n  challenge.flags = buffer.readInt32LE(20);\n  challenge.nonce = buffer.slice(24, 32);\n  challenge.zeroes = buffer.slice(32, 40);\n  challenge.targetLen = buffer.readInt16LE(40);\n  challenge.targetMax = buffer.readInt16LE(42);\n  challenge.targetOffset = buffer.readInt32LE(44);\n  challenge.oddData = buffer.slice(48, 56);\n  challenge.domain = buffer.slice(56, 56 + challenge.domainLen).toString('ucs2');\n  challenge.target = buffer.slice(56 + challenge.domainLen, 56 + challenge.domainLen + challenge.targetLen);\n\n  return challenge as Data;\n}\n\nfunction sspiParser(parser: Parser, _options: ParserOptions, callback: (token: SSPIToken) => void) {\n  parser.readUsVarByte((buffer) => {\n    callback(new SSPIToken(parseChallenge(buffer), buffer));\n  });\n}\n\nexport default sspiParser;\nmodule.exports = sspiParser;\n"],"mappings":";;;;;;AAEA,IAAAA,MAAA,GAAAC,OAAA;AAmBA,SAASC,cAATA,CAAwBC,MAAxB,EAAwC;EACtC,IAAMC,SAAwB,GAAG,EAAjC;EAEAA,SAAS,CAACC,KAAV,GAAkBF,MAAM,CAACG,KAAP,CAAa,CAAb,EAAgB,CAAhB,EAAmBC,QAAnB,CAA4B,MAA5B,CAAlB;EACAH,SAAS,CAACI,IAAV,GAAiBL,MAAM,CAACM,WAAP,CAAmB,CAAnB,CAAjB;EACAL,SAAS,CAACM,SAAV,GAAsBP,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAtB;EACAP,SAAS,CAACQ,SAAV,GAAsBT,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAtB;EACAP,SAAS,CAACS,YAAV,GAAyBV,MAAM,CAACM,WAAP,CAAmB,EAAnB,CAAzB;EACAL,SAAS,CAACU,KAAV,GAAkBX,MAAM,CAACM,WAAP,CAAmB,EAAnB,CAAlB;EACAL,SAAS,CAACW,KAAV,GAAkBZ,MAAM,CAACG,KAAP,CAAa,EAAb,EAAiB,EAAjB,CAAlB;EACAF,SAAS,CAACY,MAAV,GAAmBb,MAAM,CAACG,KAAP,CAAa,EAAb,EAAiB,EAAjB,CAAnB;EACAF,SAAS,CAACa,SAAV,GAAsBd,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAtB;EACAP,SAAS,CAACc,SAAV,GAAsBf,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAtB;EACAP,SAAS,CAACe,YAAV,GAAyBhB,MAAM,CAACM,WAAP,CAAmB,EAAnB,CAAzB;EACAL,SAAS,CAACgB,OAAV,GAAoBjB,MAAM,CAACG,KAAP,CAAa,EAAb,EAAiB,EAAjB,CAApB;EACAF,SAAS,CAACiB,MAAV,GAAmBlB,MAAM,CAACG,KAAP,CAAa,EAAb,EAAiB,KAAKF,SAAS,CAACM,SAAhC,EAA2CH,QAA3C,CAAoD,MAApD,CAAnB;EACAH,SAAS,CAACkB,MAAV,GAAmBnB,MAAM,CAACG,KAAP,CAAa,KAAKF,SAAS,CAACM,SAA5B,EAAuC,KAAKN,SAAS,CAACM,SAAf,GAA2BN,SAAS,CAACa,SAA5E,CAAnB;EAEA,OAAOb,SAAP;AACD;AAED,SAASmB,UAATA,CAAoBC,MAApB,EAAoCC,QAApC,EAA6DC,QAA7D,EAAmG;EACjGF,MAAM,CAACG,aAAP,CAAsB,UAAAxB,MAAD,EAAY;IAC/BuB,QAAQ,CAAC,IAAI1B,MAAA,CAAA4B,SAAJ,CAAc1B,cAAc,CAACC,MAAD,CAA5B,EAAsCA,MAAtC,CAAD,CAAR;EACD,CAFD;AAGD;eAEcoB,U;;AACfM,MAAM,CAACC,OAAP,GAAiBP,UAAjB"},"metadata":{},"sourceType":"script"}