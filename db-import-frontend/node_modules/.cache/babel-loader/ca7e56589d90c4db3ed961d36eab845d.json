{"ast":null,"code":"'use strict';\n\nvar fs = require('graceful-fs');\nvar path = require('path');\nvar copySync = require('../copy-sync').copySync;\nvar removeSync = require('../remove').removeSync;\nvar mkdirpSync = require('../mkdirs').mkdirsSync;\nvar buffer = require('../util/buffer');\nfunction moveSync(src, dest, options) {\n  options = options || {};\n  var overwrite = options.overwrite || options.clobber || false;\n  src = path.resolve(src);\n  dest = path.resolve(dest);\n  if (src === dest) return fs.accessSync(src);\n  if (isSrcSubdir(src, dest)) throw new Error(\"Cannot move '\".concat(src, \"' into itself '\").concat(dest, \"'.\"));\n  mkdirpSync(path.dirname(dest));\n  tryRenameSync();\n  function tryRenameSync() {\n    if (overwrite) {\n      try {\n        return fs.renameSync(src, dest);\n      } catch (err) {\n        if (err.code === 'ENOTEMPTY' || err.code === 'EEXIST' || err.code === 'EPERM') {\n          removeSync(dest);\n          options.overwrite = false; // just overwriteed it, no need to do it again\n          return moveSync(src, dest, options);\n        }\n        if (err.code !== 'EXDEV') throw err;\n        return moveSyncAcrossDevice(src, dest, overwrite);\n      }\n    } else {\n      try {\n        fs.linkSync(src, dest);\n        return fs.unlinkSync(src);\n      } catch (err) {\n        if (err.code === 'EXDEV' || err.code === 'EISDIR' || err.code === 'EPERM' || err.code === 'ENOTSUP') {\n          return moveSyncAcrossDevice(src, dest, overwrite);\n        }\n        throw err;\n      }\n    }\n  }\n}\nfunction moveSyncAcrossDevice(src, dest, overwrite) {\n  var stat = fs.statSync(src);\n  if (stat.isDirectory()) {\n    return moveDirSyncAcrossDevice(src, dest, overwrite);\n  } else {\n    return moveFileSyncAcrossDevice(src, dest, overwrite);\n  }\n}\nfunction moveFileSyncAcrossDevice(src, dest, overwrite) {\n  var BUF_LENGTH = 64 * 1024;\n  var _buff = buffer(BUF_LENGTH);\n  var flags = overwrite ? 'w' : 'wx';\n  var fdr = fs.openSync(src, 'r');\n  var stat = fs.fstatSync(fdr);\n  var fdw = fs.openSync(dest, flags, stat.mode);\n  var pos = 0;\n  while (pos < stat.size) {\n    var bytesRead = fs.readSync(fdr, _buff, 0, BUF_LENGTH, pos);\n    fs.writeSync(fdw, _buff, 0, bytesRead);\n    pos += bytesRead;\n  }\n  fs.closeSync(fdr);\n  fs.closeSync(fdw);\n  return fs.unlinkSync(src);\n}\nfunction moveDirSyncAcrossDevice(src, dest, overwrite) {\n  var options = {\n    overwrite: false\n  };\n  if (overwrite) {\n    removeSync(dest);\n    tryCopySync();\n  } else {\n    tryCopySync();\n  }\n  function tryCopySync() {\n    copySync(src, dest, options);\n    return removeSync(src);\n  }\n}\n\n// return true if dest is a subdir of src, otherwise false.\n// extract dest base dir and check if that is the same as src basename\nfunction isSrcSubdir(src, dest) {\n  try {\n    return fs.statSync(src).isDirectory() && src !== dest && dest.indexOf(src) > -1 && dest.split(path.dirname(src) + path.sep)[1].split(path.sep)[0] === path.basename(src);\n  } catch (e) {\n    return false;\n  }\n}\nmodule.exports = {\n  moveSync: moveSync\n};","map":{"version":3,"names":["fs","require","path","copySync","removeSync","mkdirpSync","mkdirsSync","buffer","moveSync","src","dest","options","overwrite","clobber","resolve","accessSync","isSrcSubdir","Error","concat","dirname","tryRenameSync","renameSync","err","code","moveSyncAcrossDevice","linkSync","unlinkSync","stat","statSync","isDirectory","moveDirSyncAcrossDevice","moveFileSyncAcrossDevice","BUF_LENGTH","_buff","flags","fdr","openSync","fstatSync","fdw","mode","pos","size","bytesRead","readSync","writeSync","closeSync","tryCopySync","indexOf","split","sep","basename","e","module","exports"],"sources":["/Users/aribraun/Desktop/db-import/node_modules/mock-aws-s3/node_modules/fs-extra/lib/move-sync/index.js"],"sourcesContent":["'use strict'\n\nconst fs = require('graceful-fs')\nconst path = require('path')\nconst copySync = require('../copy-sync').copySync\nconst removeSync = require('../remove').removeSync\nconst mkdirpSync = require('../mkdirs').mkdirsSync\nconst buffer = require('../util/buffer')\n\nfunction moveSync (src, dest, options) {\n  options = options || {}\n  const overwrite = options.overwrite || options.clobber || false\n\n  src = path.resolve(src)\n  dest = path.resolve(dest)\n\n  if (src === dest) return fs.accessSync(src)\n\n  if (isSrcSubdir(src, dest)) throw new Error(`Cannot move '${src}' into itself '${dest}'.`)\n\n  mkdirpSync(path.dirname(dest))\n  tryRenameSync()\n\n  function tryRenameSync () {\n    if (overwrite) {\n      try {\n        return fs.renameSync(src, dest)\n      } catch (err) {\n        if (err.code === 'ENOTEMPTY' || err.code === 'EEXIST' || err.code === 'EPERM') {\n          removeSync(dest)\n          options.overwrite = false // just overwriteed it, no need to do it again\n          return moveSync(src, dest, options)\n        }\n\n        if (err.code !== 'EXDEV') throw err\n        return moveSyncAcrossDevice(src, dest, overwrite)\n      }\n    } else {\n      try {\n        fs.linkSync(src, dest)\n        return fs.unlinkSync(src)\n      } catch (err) {\n        if (err.code === 'EXDEV' || err.code === 'EISDIR' || err.code === 'EPERM' || err.code === 'ENOTSUP') {\n          return moveSyncAcrossDevice(src, dest, overwrite)\n        }\n        throw err\n      }\n    }\n  }\n}\n\nfunction moveSyncAcrossDevice (src, dest, overwrite) {\n  const stat = fs.statSync(src)\n\n  if (stat.isDirectory()) {\n    return moveDirSyncAcrossDevice(src, dest, overwrite)\n  } else {\n    return moveFileSyncAcrossDevice(src, dest, overwrite)\n  }\n}\n\nfunction moveFileSyncAcrossDevice (src, dest, overwrite) {\n  const BUF_LENGTH = 64 * 1024\n  const _buff = buffer(BUF_LENGTH)\n\n  const flags = overwrite ? 'w' : 'wx'\n\n  const fdr = fs.openSync(src, 'r')\n  const stat = fs.fstatSync(fdr)\n  const fdw = fs.openSync(dest, flags, stat.mode)\n  let pos = 0\n\n  while (pos < stat.size) {\n    const bytesRead = fs.readSync(fdr, _buff, 0, BUF_LENGTH, pos)\n    fs.writeSync(fdw, _buff, 0, bytesRead)\n    pos += bytesRead\n  }\n\n  fs.closeSync(fdr)\n  fs.closeSync(fdw)\n  return fs.unlinkSync(src)\n}\n\nfunction moveDirSyncAcrossDevice (src, dest, overwrite) {\n  const options = {\n    overwrite: false\n  }\n\n  if (overwrite) {\n    removeSync(dest)\n    tryCopySync()\n  } else {\n    tryCopySync()\n  }\n\n  function tryCopySync () {\n    copySync(src, dest, options)\n    return removeSync(src)\n  }\n}\n\n// return true if dest is a subdir of src, otherwise false.\n// extract dest base dir and check if that is the same as src basename\nfunction isSrcSubdir (src, dest) {\n  try {\n    return fs.statSync(src).isDirectory() &&\n           src !== dest &&\n           dest.indexOf(src) > -1 &&\n           dest.split(path.dirname(src) + path.sep)[1].split(path.sep)[0] === path.basename(src)\n  } catch (e) {\n    return false\n  }\n}\n\nmodule.exports = {\n  moveSync\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}