{"ast":null,"code":"'use strict';\n\nmodule.exports = exports = unpublish;\nexports.usage = 'Unpublishes pre-built binary (requires aws-sdk)';\nvar log = require('npmlog');\nvar versioning = require('./util/versioning.js');\nvar napi = require('./util/napi.js');\nvar s3_setup = require('./util/s3_setup.js');\nvar url = require('url');\nfunction unpublish(gyp, argv, callback) {\n  var package_json = gyp.package_json;\n  var napi_build_version = napi.get_napi_build_version_from_command_args(argv);\n  var opts = versioning.evaluate(package_json, gyp.opts, napi_build_version);\n  var config = {};\n  s3_setup.detect(opts, config);\n  var s3 = s3_setup.get_s3(config);\n  var key_name = url.resolve(config.prefix, opts.package_name);\n  var s3_opts = {\n    Bucket: config.bucket,\n    Key: key_name\n  };\n  s3.headObject(s3_opts, function (err, meta) {\n    if (err && err.code === 'NotFound') {\n      console.log('[' + package_json.name + '] Not found: https://' + s3_opts.Bucket + '.s3.amazonaws.com/' + s3_opts.Key);\n      return callback();\n    } else if (err) {\n      return callback(err);\n    } else {\n      log.info('unpublish', JSON.stringify(meta));\n      s3.deleteObject(s3_opts, function (err2, resp) {\n        if (err2) return callback(err2);\n        log.info(JSON.stringify(resp));\n        console.log('[' + package_json.name + '] Success: removed https://' + s3_opts.Bucket + '.s3.amazonaws.com/' + s3_opts.Key);\n        return callback();\n      });\n    }\n  });\n}","map":{"version":3,"names":["module","exports","unpublish","usage","log","require","versioning","napi","s3_setup","url","gyp","argv","callback","package_json","napi_build_version","get_napi_build_version_from_command_args","opts","evaluate","config","detect","s3","get_s3","key_name","resolve","prefix","package_name","s3_opts","Bucket","bucket","Key","headObject","err","meta","code","console","name","info","JSON","stringify","deleteObject","err2","resp"],"sources":["/Users/aribraun/Desktop/db-import/node_modules/@mapbox/node-pre-gyp/lib/unpublish.js"],"sourcesContent":["'use strict';\n\nmodule.exports = exports = unpublish;\n\nexports.usage = 'Unpublishes pre-built binary (requires aws-sdk)';\n\nconst log = require('npmlog');\nconst versioning = require('./util/versioning.js');\nconst napi = require('./util/napi.js');\nconst s3_setup = require('./util/s3_setup.js');\nconst url = require('url');\n\nfunction unpublish(gyp, argv, callback) {\n  const package_json = gyp.package_json;\n  const napi_build_version = napi.get_napi_build_version_from_command_args(argv);\n  const opts = versioning.evaluate(package_json, gyp.opts, napi_build_version);\n  const config = {};\n  s3_setup.detect(opts, config);\n  const s3 = s3_setup.get_s3(config);\n  const key_name = url.resolve(config.prefix, opts.package_name);\n  const s3_opts = {\n    Bucket: config.bucket,\n    Key: key_name\n  };\n  s3.headObject(s3_opts, (err, meta) => {\n    if (err && err.code === 'NotFound') {\n      console.log('[' + package_json.name + '] Not found: https://' + s3_opts.Bucket + '.s3.amazonaws.com/' + s3_opts.Key);\n      return callback();\n    } else if (err) {\n      return callback(err);\n    } else {\n      log.info('unpublish', JSON.stringify(meta));\n      s3.deleteObject(s3_opts, (err2, resp) => {\n        if (err2) return callback(err2);\n        log.info(JSON.stringify(resp));\n        console.log('[' + package_json.name + '] Success: removed https://' + s3_opts.Bucket + '.s3.amazonaws.com/' + s3_opts.Key);\n        return callback();\n      });\n    }\n  });\n}\n"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,GAAGA,OAAO,GAAGC,SAAS;AAEpCD,OAAO,CAACE,KAAK,GAAG,iDAAiD;AAEjE,IAAMC,GAAG,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAC7B,IAAMC,UAAU,GAAGD,OAAO,CAAC,sBAAsB,CAAC;AAClD,IAAME,IAAI,GAAGF,OAAO,CAAC,gBAAgB,CAAC;AACtC,IAAMG,QAAQ,GAAGH,OAAO,CAAC,oBAAoB,CAAC;AAC9C,IAAMI,GAAG,GAAGJ,OAAO,CAAC,KAAK,CAAC;AAE1B,SAASH,SAASA,CAACQ,GAAG,EAAEC,IAAI,EAAEC,QAAQ,EAAE;EACtC,IAAMC,YAAY,GAAGH,GAAG,CAACG,YAAY;EACrC,IAAMC,kBAAkB,GAAGP,IAAI,CAACQ,wCAAwC,CAACJ,IAAI,CAAC;EAC9E,IAAMK,IAAI,GAAGV,UAAU,CAACW,QAAQ,CAACJ,YAAY,EAAEH,GAAG,CAACM,IAAI,EAAEF,kBAAkB,CAAC;EAC5E,IAAMI,MAAM,GAAG,CAAC,CAAC;EACjBV,QAAQ,CAACW,MAAM,CAACH,IAAI,EAAEE,MAAM,CAAC;EAC7B,IAAME,EAAE,GAAGZ,QAAQ,CAACa,MAAM,CAACH,MAAM,CAAC;EAClC,IAAMI,QAAQ,GAAGb,GAAG,CAACc,OAAO,CAACL,MAAM,CAACM,MAAM,EAAER,IAAI,CAACS,YAAY,CAAC;EAC9D,IAAMC,OAAO,GAAG;IACdC,MAAM,EAAET,MAAM,CAACU,MAAM;IACrBC,GAAG,EAAEP;EACP,CAAC;EACDF,EAAE,CAACU,UAAU,CAACJ,OAAO,EAAE,UAACK,GAAG,EAAEC,IAAI,EAAK;IACpC,IAAID,GAAG,IAAIA,GAAG,CAACE,IAAI,KAAK,UAAU,EAAE;MAClCC,OAAO,CAAC9B,GAAG,CAAC,GAAG,GAAGS,YAAY,CAACsB,IAAI,GAAG,uBAAuB,GAAGT,OAAO,CAACC,MAAM,GAAG,oBAAoB,GAAGD,OAAO,CAACG,GAAG,CAAC;MACpH,OAAOjB,QAAQ,CAAC,CAAC;IACnB,CAAC,MAAM,IAAImB,GAAG,EAAE;MACd,OAAOnB,QAAQ,CAACmB,GAAG,CAAC;IACtB,CAAC,MAAM;MACL3B,GAAG,CAACgC,IAAI,CAAC,WAAW,EAAEC,IAAI,CAACC,SAAS,CAACN,IAAI,CAAC,CAAC;MAC3CZ,EAAE,CAACmB,YAAY,CAACb,OAAO,EAAE,UAACc,IAAI,EAAEC,IAAI,EAAK;QACvC,IAAID,IAAI,EAAE,OAAO5B,QAAQ,CAAC4B,IAAI,CAAC;QAC/BpC,GAAG,CAACgC,IAAI,CAACC,IAAI,CAACC,SAAS,CAACG,IAAI,CAAC,CAAC;QAC9BP,OAAO,CAAC9B,GAAG,CAAC,GAAG,GAAGS,YAAY,CAACsB,IAAI,GAAG,6BAA6B,GAAGT,OAAO,CAACC,MAAM,GAAG,oBAAoB,GAAGD,OAAO,CAACG,GAAG,CAAC;QAC1H,OAAOjB,QAAQ,CAAC,CAAC;MACnB,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"script"}