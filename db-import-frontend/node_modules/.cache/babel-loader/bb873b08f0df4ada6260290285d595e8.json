{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _token = require(\"./token\");\nvar FEDAUTHINFOID = {\n  STSURL: 0x01,\n  SPN: 0x02\n};\nfunction fedAuthInfoParser(parser, _options, callback) {\n  parser.readUInt32LE(function (tokenLength) {\n    parser.readBuffer(tokenLength, function (data) {\n      var spn, stsurl;\n      var offset = 0;\n      var countOfInfoIDs = data.readUInt32LE(offset);\n      offset += 4;\n      for (var i = 0; i < countOfInfoIDs; i++) {\n        var fedauthInfoID = data.readUInt8(offset);\n        offset += 1;\n        var fedAuthInfoDataLen = data.readUInt32LE(offset);\n        offset += 4;\n        var fedAuthInfoDataOffset = data.readUInt32LE(offset);\n        offset += 4;\n        switch (fedauthInfoID) {\n          case FEDAUTHINFOID.SPN:\n            spn = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n          case FEDAUTHINFOID.STSURL:\n            stsurl = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n          // ignoring unknown fedauthinfo options\n\n          default:\n            break;\n        }\n      }\n      callback(new _token.FedAuthInfoToken(spn, stsurl));\n    });\n  });\n}\nvar _default = fedAuthInfoParser;\nexports.default = _default;\nmodule.exports = fedAuthInfoParser;","map":{"version":3,"names":["_token","require","FEDAUTHINFOID","STSURL","SPN","fedAuthInfoParser","parser","_options","callback","readUInt32LE","tokenLength","readBuffer","data","spn","stsurl","offset","countOfInfoIDs","i","fedauthInfoID","readUInt8","fedAuthInfoDataLen","fedAuthInfoDataOffset","toString","FedAuthInfoToken","module","exports"],"sources":["../../src/token/fedauth-info-parser.ts"],"sourcesContent":["import Parser, { ParserOptions } from './stream-parser';\nimport { FedAuthInfoToken } from './token';\n\nconst FEDAUTHINFOID = {\n  STSURL: 0x01,\n  SPN: 0x02\n};\n\nfunction fedAuthInfoParser(parser: Parser, _options: ParserOptions, callback: (token: FedAuthInfoToken) => void) {\n  parser.readUInt32LE((tokenLength) => {\n    parser.readBuffer(tokenLength, (data) => {\n      let spn: string | undefined, stsurl: string | undefined;\n\n      let offset = 0;\n\n      const countOfInfoIDs = data.readUInt32LE(offset);\n      offset += 4;\n\n      for (let i = 0; i < countOfInfoIDs; i++) {\n        const fedauthInfoID = data.readUInt8(offset);\n        offset += 1;\n\n        const fedAuthInfoDataLen = data.readUInt32LE(offset);\n        offset += 4;\n\n        const fedAuthInfoDataOffset = data.readUInt32LE(offset);\n        offset += 4;\n\n        switch (fedauthInfoID) {\n          case FEDAUTHINFOID.SPN:\n            spn = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n\n          case FEDAUTHINFOID.STSURL:\n            stsurl = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n\n          // ignoring unknown fedauthinfo options\n          default:\n            break;\n        }\n      }\n\n      callback(new FedAuthInfoToken(spn, stsurl));\n    });\n  });\n}\n\nexport default fedAuthInfoParser;\nmodule.exports = fedAuthInfoParser;\n"],"mappings":";;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAMC,aAAa,GAAG;EACpBC,MAAM,EAAE,IADY;EAEpBC,GAAG,EAAE;AAFe,CAAtB;AAKA,SAASC,iBAATA,CAA2BC,MAA3B,EAA2CC,QAA3C,EAAoEC,QAApE,EAAiH;EAC/GF,MAAM,CAACG,YAAP,CAAqB,UAAAC,WAAD,EAAiB;IACnCJ,MAAM,CAACK,UAAP,CAAkBD,WAAlB,EAAgC,UAAAE,IAAD,EAAU;MACvC,IAAIC,GAAJ,EAA6BC,MAA7B;MAEA,IAAIC,MAAM,GAAG,CAAb;MAEA,IAAMC,cAAc,GAAGJ,IAAI,CAACH,YAAL,CAAkBM,MAAlB,CAAvB;MACAA,MAAM,IAAI,CAAV;MAEA,KAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,cAApB,EAAoCC,CAAC,EAArC,EAAyC;QACvC,IAAMC,aAAa,GAAGN,IAAI,CAACO,SAAL,CAAeJ,MAAf,CAAtB;QACAA,MAAM,IAAI,CAAV;QAEA,IAAMK,kBAAkB,GAAGR,IAAI,CAACH,YAAL,CAAkBM,MAAlB,CAA3B;QACAA,MAAM,IAAI,CAAV;QAEA,IAAMM,qBAAqB,GAAGT,IAAI,CAACH,YAAL,CAAkBM,MAAlB,CAA9B;QACAA,MAAM,IAAI,CAAV;QAEA,QAAQG,aAAR;UACE,KAAKhB,aAAa,CAACE,GAAnB;YACES,GAAG,GAAGD,IAAI,CAACU,QAAL,CAAc,MAAd,EAAsBD,qBAAtB,EAA6CA,qBAAqB,GAAGD,kBAArE,CAAN;YACA;UAEF,KAAKlB,aAAa,CAACC,MAAnB;YACEW,MAAM,GAAGF,IAAI,CAACU,QAAL,CAAc,MAAd,EAAsBD,qBAAtB,EAA6CA,qBAAqB,GAAGD,kBAArE,CAAT;YACA;UAEF;;UACA;YACE;QAXJ;MAaD;MAEDZ,QAAQ,CAAC,IAAIR,MAAA,CAAAuB,gBAAJ,CAAqBV,GAArB,EAA0BC,MAA1B,CAAD,CAAR;IACD,CAlCD;EAmCD,CApCD;AAqCD;eAEcT,iB;;AACfmB,MAAM,CAACC,OAAP,GAAiBpB,iBAAjB"},"metadata":{},"sourceType":"script"}