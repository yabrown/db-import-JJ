{"ast":null,"code":"/*! @azure/msal-browser v2.37.0 2023-05-01 */\n'use strict';\n\nimport { __awaiter, __generator } from '../_virtual/_tslib.js';\nimport { BrowserAuthError } from '../error/BrowserAuthError.js';\nimport { DB_NAME, DB_VERSION, DB_TABLE_NAME } from '../utils/BrowserConstants.js';\n\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n/**\r\n * Storage wrapper for IndexedDB storage in browsers: https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\r\n */\nvar DatabaseStorage = /** @class */function () {\n  function DatabaseStorage() {\n    this.dbName = DB_NAME;\n    this.version = DB_VERSION;\n    this.tableName = DB_TABLE_NAME;\n    this.dbOpen = false;\n  }\n  /**\r\n   * Opens IndexedDB instance.\r\n   */\n  DatabaseStorage.prototype.open = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n          var openDB = window.indexedDB.open(_this.dbName, _this.version);\n          openDB.addEventListener(\"upgradeneeded\", function (e) {\n            var event = e;\n            event.target.result.createObjectStore(_this.tableName);\n          });\n          openDB.addEventListener(\"success\", function (e) {\n            var event = e;\n            _this.db = event.target.result;\n            _this.dbOpen = true;\n            resolve();\n          });\n          openDB.addEventListener(\"error\", function () {\n            return reject(BrowserAuthError.createDatabaseUnavailableError());\n          });\n        })];\n      });\n    });\n  };\n  /**\r\n   * Closes the connection to IndexedDB database when all pending transactions\r\n   * complete.\r\n   */\n  DatabaseStorage.prototype.closeConnection = function () {\n    var db = this.db;\n    if (db && this.dbOpen) {\n      db.close();\n      this.dbOpen = false;\n    }\n  };\n  /**\r\n   * Opens database if it's not already open\r\n   */\n  DatabaseStorage.prototype.validateDbIsOpen = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!!this.dbOpen) return [3 /*break*/, 2];\n            return [4 /*yield*/, this.open()];\n          case 1:\n            return [2 /*return*/, _a.sent()];\n          case 2:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\r\n   * Retrieves item from IndexedDB instance.\r\n   * @param key\r\n   */\n  DatabaseStorage.prototype.getItem = function (key) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.validateDbIsOpen()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              // TODO: Add timeouts?\n              if (!_this.db) {\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\n              }\n              var transaction = _this.db.transaction([_this.tableName], \"readonly\");\n              var objectStore = transaction.objectStore(_this.tableName);\n              var dbGet = objectStore.get(key);\n              dbGet.addEventListener(\"success\", function (e) {\n                var event = e;\n                _this.closeConnection();\n                resolve(event.target.result);\n              });\n              dbGet.addEventListener(\"error\", function (e) {\n                _this.closeConnection();\n                reject(e);\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\r\n   * Adds item to IndexedDB under given key\r\n   * @param key\r\n   * @param payload\r\n   */\n  DatabaseStorage.prototype.setItem = function (key, payload) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.validateDbIsOpen()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              // TODO: Add timeouts?\n              if (!_this.db) {\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\n              }\n              var transaction = _this.db.transaction([_this.tableName], \"readwrite\");\n              var objectStore = transaction.objectStore(_this.tableName);\n              var dbPut = objectStore.put(payload, key);\n              dbPut.addEventListener(\"success\", function () {\n                _this.closeConnection();\n                resolve();\n              });\n              dbPut.addEventListener(\"error\", function (e) {\n                _this.closeConnection();\n                reject(e);\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\r\n   * Removes item from IndexedDB under given key\r\n   * @param key\r\n   */\n  DatabaseStorage.prototype.removeItem = function (key) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.validateDbIsOpen()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              if (!_this.db) {\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\n              }\n              var transaction = _this.db.transaction([_this.tableName], \"readwrite\");\n              var objectStore = transaction.objectStore(_this.tableName);\n              var dbDelete = objectStore.delete(key);\n              dbDelete.addEventListener(\"success\", function () {\n                _this.closeConnection();\n                resolve();\n              });\n              dbDelete.addEventListener(\"error\", function (e) {\n                _this.closeConnection();\n                reject(e);\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\r\n   * Get all the keys from the storage object as an iterable array of strings.\r\n   */\n  DatabaseStorage.prototype.getKeys = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.validateDbIsOpen()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              if (!_this.db) {\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\n              }\n              var transaction = _this.db.transaction([_this.tableName], \"readonly\");\n              var objectStore = transaction.objectStore(_this.tableName);\n              var dbGetKeys = objectStore.getAllKeys();\n              dbGetKeys.addEventListener(\"success\", function (e) {\n                var event = e;\n                _this.closeConnection();\n                resolve(event.target.result);\n              });\n              dbGetKeys.addEventListener(\"error\", function (e) {\n                _this.closeConnection();\n                reject(e);\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\r\n   *\r\n   * Checks whether there is an object under the search key in the object store\r\n   */\n  DatabaseStorage.prototype.containsKey = function (key) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.validateDbIsOpen()];\n          case 1:\n            _a.sent();\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              if (!_this.db) {\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\n              }\n              var transaction = _this.db.transaction([_this.tableName], \"readonly\");\n              var objectStore = transaction.objectStore(_this.tableName);\n              var dbContainsKey = objectStore.count(key);\n              dbContainsKey.addEventListener(\"success\", function (e) {\n                var event = e;\n                _this.closeConnection();\n                resolve(event.target.result === 1);\n              });\n              dbContainsKey.addEventListener(\"error\", function (e) {\n                _this.closeConnection();\n                reject(e);\n              });\n            })];\n        }\n      });\n    });\n  };\n  /**\r\n   * Deletes the MSAL database. The database is deleted rather than cleared to make it possible\r\n   * for client applications to downgrade to a previous MSAL version without worrying about forward compatibility issues\r\n   * with IndexedDB database versions.\r\n   */\n  DatabaseStorage.prototype.deleteDatabase = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        // Check if database being deleted exists\n        if (this.db && this.dbOpen) {\n          this.closeConnection();\n        }\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n          var deleteDbRequest = window.indexedDB.deleteDatabase(DB_NAME);\n          deleteDbRequest.addEventListener(\"success\", function () {\n            return resolve(true);\n          });\n          deleteDbRequest.addEventListener(\"blocked\", function () {\n            return resolve(true);\n          });\n          deleteDbRequest.addEventListener(\"error\", function () {\n            return reject(false);\n          });\n        })];\n      });\n    });\n  };\n  return DatabaseStorage;\n}();\nexport { DatabaseStorage };","map":{"version":3,"names":["DatabaseStorage","dbName","DB_NAME","version","DB_VERSION","tableName","DB_TABLE_NAME","dbOpen","prototype","open","Promise","resolve","reject","openDB","window","indexedDB","_this","addEventListener","e","event","target","result","createObjectStore","db","BrowserAuthError","createDatabaseUnavailableError","closeConnection","close","validateDbIsOpen","_a","sent","getItem","key","createDatabaseNotOpenError","transaction","objectStore","dbGet","get","setItem","payload","dbPut","put","removeItem","dbDelete","delete","getKeys","dbGetKeys","getAllKeys","containsKey","dbContainsKey","count","deleteDatabase","deleteDbRequest"],"sources":["../../src/cache/DatabaseStorage.ts"],"sourcesContent":["/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { BrowserAuthError } from \"../error/BrowserAuthError\";\r\nimport { DB_NAME, DB_TABLE_NAME, DB_VERSION } from \"../utils/BrowserConstants\";\r\nimport { IAsyncStorage } from \"./IAsyncMemoryStorage\";\r\n\r\ninterface IDBOpenDBRequestEvent extends Event {\r\n    target: IDBOpenDBRequest & EventTarget;\r\n}\r\n\r\ninterface IDBOpenOnUpgradeNeededEvent extends IDBVersionChangeEvent {\r\n    target: IDBOpenDBRequest & EventTarget;\r\n}\r\n\r\ninterface IDBRequestEvent extends Event {\r\n    target: IDBRequest & EventTarget;\r\n}\r\n\r\n/**\r\n * Storage wrapper for IndexedDB storage in browsers: https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\r\n */\r\nexport class DatabaseStorage<T> implements IAsyncStorage<T> {\r\n    private db: IDBDatabase|undefined;\r\n    private dbName: string;\r\n    private tableName: string;\r\n    private version: number;\r\n    private dbOpen: boolean;\r\n\r\n    constructor() {\r\n        this.dbName = DB_NAME;\r\n        this.version = DB_VERSION;\r\n        this.tableName = DB_TABLE_NAME;\r\n        this.dbOpen = false;\r\n    }\r\n\r\n    /**\r\n     * Opens IndexedDB instance.\r\n     */\r\n    async open(): Promise<void> {\r\n        return new Promise((resolve, reject) => {\r\n            const openDB = window.indexedDB.open(this.dbName, this.version);\r\n            openDB.addEventListener(\"upgradeneeded\", (e: IDBVersionChangeEvent) => {\r\n                const event = e as IDBOpenOnUpgradeNeededEvent;\r\n                event.target.result.createObjectStore(this.tableName);\r\n            });\r\n            openDB.addEventListener(\"success\", (e: Event) => {\r\n                const event = e as IDBOpenDBRequestEvent;\r\n                this.db = event.target.result;\r\n                this.dbOpen = true;\r\n                resolve();\r\n            });\r\n            openDB.addEventListener(\"error\",  () => reject(BrowserAuthError.createDatabaseUnavailableError()));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Closes the connection to IndexedDB database when all pending transactions\r\n     * complete.\r\n     */\r\n    closeConnection(): void {\r\n        const db = this.db;\r\n        if (db && this.dbOpen) {\r\n            db.close();\r\n            this.dbOpen = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Opens database if it's not already open\r\n     */\r\n    private async validateDbIsOpen(): Promise<void> {\r\n        if (!this.dbOpen) {\r\n            return await this.open();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Retrieves item from IndexedDB instance.\r\n     * @param key \r\n     */\r\n    async getItem(key: string): Promise<T | null> {\r\n        await this.validateDbIsOpen();\r\n        return new Promise<T>((resolve, reject) => {\r\n            // TODO: Add timeouts?\r\n            if (!this.db) {\r\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\r\n            }\r\n            const transaction = this.db.transaction([this.tableName], \"readonly\");\r\n            const objectStore = transaction.objectStore(this.tableName);\r\n            const dbGet = objectStore.get(key);\r\n            \r\n            dbGet.addEventListener(\"success\", (e: Event) => {\r\n                const event = e as IDBRequestEvent;\r\n                this.closeConnection();\r\n                resolve(event.target.result);\r\n            });\r\n\r\n            dbGet.addEventListener(\"error\", (e: Event) => {\r\n                this.closeConnection();\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Adds item to IndexedDB under given key\r\n     * @param key \r\n     * @param payload \r\n     */\r\n    async setItem(key: string, payload: T): Promise<void> {\r\n        await this.validateDbIsOpen();\r\n        return new Promise<void>((resolve: Function, reject: Function) => {\r\n            // TODO: Add timeouts?\r\n            if (!this.db) {\r\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\r\n            }\r\n            const transaction = this.db.transaction([this.tableName], \"readwrite\");\r\n\r\n            const objectStore = transaction.objectStore(this.tableName);\r\n\r\n            const dbPut = objectStore.put(payload, key);\r\n\r\n            dbPut.addEventListener(\"success\", () => {\r\n                this.closeConnection();\r\n                resolve();\r\n            });\r\n\r\n            dbPut.addEventListener(\"error\", (e) => {\r\n                this.closeConnection();\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Removes item from IndexedDB under given key\r\n     * @param key\r\n     */\r\n    async removeItem(key: string): Promise<void> {\r\n        await this.validateDbIsOpen();\r\n        return new Promise<void>((resolve: Function, reject: Function) => {\r\n            if (!this.db) {\r\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\r\n            }\r\n\r\n            const transaction = this.db.transaction([this.tableName], \"readwrite\");\r\n            const objectStore = transaction.objectStore(this.tableName);\r\n            const dbDelete = objectStore.delete(key);\r\n\r\n            dbDelete.addEventListener(\"success\", () => {\r\n                this.closeConnection();\r\n                resolve();\r\n            });\r\n\r\n            dbDelete.addEventListener(\"error\", (e) => {\r\n                this.closeConnection();\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get all the keys from the storage object as an iterable array of strings.\r\n     */\r\n    async getKeys(): Promise<string[]> {\r\n        await this.validateDbIsOpen();\r\n        return new Promise<string[]>((resolve: Function, reject: Function) => {\r\n            if (!this.db) {\r\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\r\n            }\r\n\r\n            const transaction = this.db.transaction([this.tableName], \"readonly\");\r\n            const objectStore = transaction.objectStore(this.tableName);\r\n            const dbGetKeys = objectStore.getAllKeys();\r\n\r\n            dbGetKeys.addEventListener(\"success\", (e: Event) => {\r\n                const event = e as IDBRequestEvent;\r\n                this.closeConnection();\r\n                resolve(event.target.result);\r\n            });\r\n\r\n            dbGetKeys.addEventListener(\"error\",  (e: Event) => {\r\n                this.closeConnection();\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * Checks whether there is an object under the search key in the object store\r\n     */\r\n    async containsKey(key: string): Promise<boolean> {\r\n        await this.validateDbIsOpen();\r\n\r\n        return new Promise<boolean>((resolve: Function, reject: Function) => {\r\n            if (!this.db) {\r\n                return reject(BrowserAuthError.createDatabaseNotOpenError());\r\n            }\r\n\r\n            const transaction = this.db.transaction([this.tableName], \"readonly\");\r\n            const objectStore = transaction.objectStore(this.tableName);\r\n            const dbContainsKey = objectStore.count(key);\r\n\r\n            dbContainsKey.addEventListener(\"success\", (e: Event) => {\r\n                const event = e as IDBRequestEvent;\r\n                this.closeConnection();\r\n                resolve(event.target.result === 1);\r\n            });\r\n\r\n            dbContainsKey.addEventListener(\"error\", (e: Event) => {\r\n                this.closeConnection();\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Deletes the MSAL database. The database is deleted rather than cleared to make it possible\r\n     * for client applications to downgrade to a previous MSAL version without worrying about forward compatibility issues\r\n     * with IndexedDB database versions.\r\n     */\r\n    async deleteDatabase(): Promise<boolean> {\r\n        // Check if database being deleted exists\r\n\r\n        if (this.db && this.dbOpen) {\r\n            this.closeConnection();\r\n        }\r\n\r\n        return new Promise<boolean>((resolve: Function, reject: Function) => {\r\n            const deleteDbRequest = window.indexedDB.deleteDatabase(DB_NAME);\r\n            deleteDbRequest.addEventListener(\"success\", () => resolve(true));\r\n            deleteDbRequest.addEventListener(\"blocked\", () => resolve(true));\r\n            deleteDbRequest.addEventListener(\"error\", () => reject(false));\r\n        });\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}