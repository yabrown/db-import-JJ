{"ast":null,"code":"\"use strict\";\n\nvar _ = require(\"lodash\");\nfunction stringifyRangeBound(bound) {\n  if (bound === null) {\n    return \"\";\n  }\n  if (bound === Infinity || bound === -Infinity) {\n    return bound.toString().toLowerCase();\n  }\n  return JSON.stringify(bound);\n}\nfunction parseRangeBound(bound, parseType) {\n  if (!bound) {\n    return null;\n  }\n  if (bound === \"infinity\") {\n    return Infinity;\n  }\n  if (bound === \"-infinity\") {\n    return -Infinity;\n  }\n  return parseType(bound);\n}\nfunction stringify(data) {\n  if (data === null) return null;\n  if (!Array.isArray(data)) throw new Error(\"range must be an array\");\n  if (!data.length) return \"empty\";\n  if (data.length !== 2) throw new Error(\"range array length must be 0 (empty) or 2 (lower and upper bounds)\");\n  if (Object.prototype.hasOwnProperty.call(data, \"inclusive\")) {\n    if (data.inclusive === false) data.inclusive = [false, false];else if (!data.inclusive) data.inclusive = [true, false];else if (data.inclusive === true) data.inclusive = [true, true];\n  } else {\n    data.inclusive = [true, false];\n  }\n  _.each(data, function (value, index) {\n    if (_.isObject(value)) {\n      if (Object.prototype.hasOwnProperty.call(value, \"inclusive\")) data.inclusive[index] = !!value.inclusive;\n      if (Object.prototype.hasOwnProperty.call(value, \"value\")) data[index] = value.value;\n    }\n  });\n  var lowerBound = stringifyRangeBound(data[0]);\n  var upperBound = stringifyRangeBound(data[1]);\n  return \"\".concat((data.inclusive[0] ? \"[\" : \"(\") + lowerBound, \",\").concat(upperBound).concat(data.inclusive[1] ? \"]\" : \")\");\n}\nexports.stringify = stringify;\nfunction parse(value, parser) {\n  if (value === null) return null;\n  if (value === \"empty\") {\n    return [];\n  }\n  var result = value.substring(1, value.length - 1).split(\",\", 2);\n  if (result.length !== 2) return value;\n  result = result.map(function (item, index) {\n    return {\n      value: parseRangeBound(item, parser),\n      inclusive: index === 0 ? value[0] === \"[\" : value[value.length - 1] === \"]\"\n    };\n  });\n  return result;\n}\nexports.parse = parse;","map":{"version":3,"names":["_","require","stringifyRangeBound","bound","Infinity","toString","toLowerCase","JSON","stringify","parseRangeBound","parseType","data","Array","isArray","Error","length","Object","prototype","hasOwnProperty","call","inclusive","each","value","index","isObject","lowerBound","upperBound","concat","exports","parse","parser","result","substring","split","map","item"],"sources":["../../../src/dialects/postgres/range.js"],"sourcesContent":["'use strict';\n\nconst _ = require('lodash');\n\nfunction stringifyRangeBound(bound) {\n  if (bound === null) {\n    return '' ;\n  }\n  if (bound === Infinity || bound === -Infinity) {\n    return bound.toString().toLowerCase();\n  }\n  return JSON.stringify(bound);\n}\n\nfunction parseRangeBound(bound, parseType) {\n  if (!bound) {\n    return null;\n  }\n  if (bound === 'infinity') {\n    return Infinity;\n  }\n  if (bound === '-infinity') {\n    return -Infinity;\n  }\n  return parseType(bound);\n\n}\n\nfunction stringify(data) {\n  if (data === null) return null;\n\n  if (!Array.isArray(data)) throw new Error('range must be an array');\n  if (!data.length) return 'empty';\n  if (data.length !== 2) throw new Error('range array length must be 0 (empty) or 2 (lower and upper bounds)');\n\n  if (Object.prototype.hasOwnProperty.call(data, 'inclusive')) {\n    if (data.inclusive === false) data.inclusive = [false, false];\n    else if (!data.inclusive) data.inclusive = [true, false];\n    else if (data.inclusive === true) data.inclusive = [true, true];\n  } else {\n    data.inclusive = [true, false];\n  }\n\n  _.each(data, (value, index) => {\n    if (_.isObject(value)) {\n      if (Object.prototype.hasOwnProperty.call(value, 'inclusive')) data.inclusive[index] = !!value.inclusive;\n      if (Object.prototype.hasOwnProperty.call(value, 'value')) data[index] = value.value;\n    }\n  });\n\n  const lowerBound = stringifyRangeBound(data[0]);\n  const upperBound = stringifyRangeBound(data[1]);\n\n  return `${(data.inclusive[0] ? '[' : '(') + lowerBound},${upperBound}${data.inclusive[1] ? ']' : ')'}`;\n}\nexports.stringify = stringify;\n\nfunction parse(value, parser) {\n  if (value === null) return null;\n  if (value === 'empty') {\n    return [];\n  }\n\n  let result = value\n    .substring(1, value.length - 1)\n    .split(',', 2);\n\n  if (result.length !== 2) return value;\n\n  result = result.map((item, index) => {\n    return {\n      value: parseRangeBound(item, parser),\n      inclusive: index === 0 ? value[0] === '[' : value[value.length - 1] === ']'\n    };\n  });\n\n  return result;\n}\nexports.parse = parse;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}