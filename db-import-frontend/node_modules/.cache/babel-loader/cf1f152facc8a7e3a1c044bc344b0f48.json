{"ast":null,"code":"\"use strict\";\n\nvar _createForOfIteratorHelper = require(\"/Users/aribraun/Desktop/db-import/db-import-frontend/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _regeneratorRuntime = require(\"/Users/aribraun/Desktop/db-import/db-import-frontend/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"/Users/aribraun/Desktop/db-import/db-import-frontend/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _classCallCheck = require(\"/Users/aribraun/Desktop/db-import/db-import-frontend/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/aribraun/Desktop/db-import/db-import-frontend/node_modules/@babel/runtime/helpers/createClass.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Pool = void 0;\nvar Deferred_1 = require(\"./Deferred\");\nvar AggregateError_1 = require(\"./AggregateError\");\nvar Pool = /*#__PURE__*/function () {\n  function Pool(factory) {\n    _classCallCheck(this, Pool);\n    this.log = false;\n    if (!factory.create) {\n      throw new Error('create function is required');\n    }\n    if (!factory.destroy) {\n      throw new Error('destroy function is required');\n    }\n    if (!factory.validate) {\n      throw new Error('validate function is required');\n    }\n    if (typeof factory.min !== 'number' || factory.min < 0 || factory.min !== Math.round(factory.min)) {\n      throw new Error('min must be an integer >= 0');\n    }\n    if (typeof factory.max !== 'number' || factory.max <= 0 || factory.max !== Math.round(factory.max)) {\n      throw new Error('max must be an integer > 0');\n    }\n    if (factory.min > factory.max) {\n      throw new Error('max is smaller than min');\n    }\n    if (factory.maxUses !== undefined && (typeof factory.maxUses !== 'number' || factory.maxUses < 0)) {\n      throw new Error('maxUses must be an integer >= 0');\n    }\n    this.idleTimeoutMillis = factory.idleTimeoutMillis || 30000;\n    this.acquireTimeoutMillis = factory.acquireTimeoutMillis || 30000;\n    this.reapIntervalMillis = factory.reapIntervalMillis || 1000;\n    this.maxUsesPerResource = factory.maxUses || Infinity;\n    this.log = factory.log || false;\n    this._factory = factory;\n    this._count = 0;\n    this._draining = false;\n    this._pendingAcquires = [];\n    this._inUseObjects = [];\n    this._availableObjects = [];\n    this._removeIdleScheduled = false;\n  }\n  _createClass(Pool, [{\n    key: \"size\",\n    get: function get() {\n      return this._count;\n    }\n  }, {\n    key: \"name\",\n    get: function get() {\n      return this._factory.name;\n    }\n  }, {\n    key: \"available\",\n    get: function get() {\n      return this._availableObjects.length;\n    }\n  }, {\n    key: \"using\",\n    get: function get() {\n      return this._inUseObjects.length;\n    }\n  }, {\n    key: \"waiting\",\n    get: function get() {\n      return this._pendingAcquires.length;\n    }\n  }, {\n    key: \"maxSize\",\n    get: function get() {\n      return this._factory.max;\n    }\n  }, {\n    key: \"minSize\",\n    get: function get() {\n      return this._factory.min;\n    }\n  }, {\n    key: \"_log\",\n    value: function _log(message, level) {\n      if (typeof this.log === 'function') {\n        this.log(message, level);\n      } else if (this.log) {\n        console.log(\"\".concat(level.toUpperCase(), \" pool \").concat(this.name || '', \" - \").concat(message));\n      }\n    }\n  }, {\n    key: \"_removeIdle\",\n    value: function _removeIdle() {\n      var toRemove = [];\n      var now = Date.now();\n      var i;\n      var available = this._availableObjects.length;\n      var maxRemovable = this.size - this.minSize;\n      var timeout;\n      this._removeIdleScheduled = false;\n      for (i = 0; i < available && maxRemovable > toRemove.length; i++) {\n        timeout = this._availableObjects[i].timeout;\n        if (now >= timeout) {\n          this._log('removeIdle() destroying obj - now:' + now + ' timeout:' + timeout, 'verbose');\n          toRemove.push(this._availableObjects[i].resource);\n        }\n      }\n      toRemove.forEach(this.destroy, this);\n      available = this._availableObjects.length;\n      if (available > 0) {\n        this._log('this._availableObjects.length=' + available, 'verbose');\n        this._scheduleRemoveIdle();\n      } else {\n        this._log('removeIdle() all objects removed', 'verbose');\n      }\n    }\n  }, {\n    key: \"_scheduleRemoveIdle\",\n    value: function _scheduleRemoveIdle() {\n      var _this = this;\n      if (!this._removeIdleScheduled) {\n        this._removeIdleScheduled = true;\n        this._removeIdleTimer = setTimeout(function () {\n          _this._removeIdle();\n        }, this.reapIntervalMillis);\n      }\n    }\n  }, {\n    key: \"_dispense\",\n    value: function _dispense() {\n      var wrappedResource = null;\n      var waitingCount = this._pendingAcquires.length;\n      this._log(\"dispense() clients=\".concat(waitingCount, \" available=\").concat(this._availableObjects.length), 'info');\n      if (waitingCount < 1) {\n        return;\n      }\n      while (this._availableObjects.length > 0) {\n        this._log('dispense() - reusing obj', 'verbose');\n        wrappedResource = this._availableObjects[this._availableObjects.length - 1];\n        if (!this._factory.validate(wrappedResource.resource)) {\n          this.destroy(wrappedResource.resource);\n          continue;\n        }\n        this._availableObjects.pop();\n        this._addResourceToInUseObjects(wrappedResource.resource, wrappedResource.useCount);\n        var deferred = this._pendingAcquires.shift();\n        return deferred.resolve(wrappedResource.resource);\n      }\n      if (this.size < this.maxSize) {\n        this._createResource();\n      }\n    }\n  }, {\n    key: \"_createResource\",\n    value: function _createResource() {\n      var _this2 = this;\n      this._count += 1;\n      this._log(\"createResource() - creating obj - count=\".concat(this.size, \" min=\").concat(this.minSize, \" max=\").concat(this.maxSize), 'verbose');\n      this._factory.create().then(function (resource) {\n        var deferred = _this2._pendingAcquires.shift();\n        if (deferred) {\n          _this2._addResourceToInUseObjects(resource, 0);\n          deferred.resolve(resource);\n        } else {\n          _this2._addResourceToAvailableObjects(resource, 0);\n        }\n      }).catch(function (error) {\n        var deferred = _this2._pendingAcquires.shift();\n        _this2._count -= 1;\n        if (_this2._count < 0) _this2._count = 0;\n        if (deferred) {\n          deferred.reject(error);\n        }\n        process.nextTick(function () {\n          _this2._dispense();\n        });\n      });\n    }\n  }, {\n    key: \"_addResourceToAvailableObjects\",\n    value: function _addResourceToAvailableObjects(resource, useCount) {\n      var wrappedResource = {\n        resource: resource,\n        useCount: useCount,\n        timeout: Date.now() + this.idleTimeoutMillis\n      };\n      this._availableObjects.push(wrappedResource);\n      this._dispense();\n      this._scheduleRemoveIdle();\n    }\n  }, {\n    key: \"_addResourceToInUseObjects\",\n    value: function _addResourceToInUseObjects(resource, useCount) {\n      var wrappedResource = {\n        resource: resource,\n        useCount: useCount\n      };\n      this._inUseObjects.push(wrappedResource);\n    }\n  }, {\n    key: \"_ensureMinimum\",\n    value: function _ensureMinimum() {\n      var i, diff;\n      if (!this._draining && this.size < this.minSize) {\n        diff = this.minSize - this.size;\n        for (i = 0; i < diff; i++) {\n          this._createResource();\n        }\n      }\n    }\n  }, {\n    key: \"acquire\",\n    value: function acquire() {\n      var _this3 = this;\n      if (this._draining) {\n        return Promise.reject(new Error('pool is draining and cannot accept work'));\n      }\n      var deferred = new Deferred_1.Deferred();\n      deferred.registerTimeout(this.acquireTimeoutMillis, function () {\n        _this3._pendingAcquires = _this3._pendingAcquires.filter(function (pending) {\n          return pending !== deferred;\n        });\n      });\n      this._pendingAcquires.push(deferred);\n      this._dispense();\n      return deferred.promise();\n    }\n  }, {\n    key: \"release\",\n    value: function release(resource) {\n      if (this._availableObjects.some(function (resourceWithTimeout) {\n        return resourceWithTimeout.resource === resource;\n      })) {\n        this._log('release called twice for the same resource: ' + new Error().stack, 'error');\n        return;\n      }\n      var index = this._inUseObjects.findIndex(function (wrappedResource) {\n        return wrappedResource.resource === resource;\n      });\n      if (index < 0) {\n        this._log('attempt to release an invalid resource: ' + new Error().stack, 'error');\n        return;\n      }\n      var wrappedResource = this._inUseObjects[index];\n      wrappedResource.useCount += 1;\n      if (wrappedResource.useCount >= this.maxUsesPerResource) {\n        this._log('release() destroying obj - useCount:' + wrappedResource.useCount + ' maxUsesPerResource:' + this.maxUsesPerResource, 'verbose');\n        this.destroy(wrappedResource.resource);\n        this._dispense();\n      } else {\n        this._inUseObjects.splice(index, 1);\n        this._addResourceToAvailableObjects(wrappedResource.resource, wrappedResource.useCount);\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function () {\n      var _destroy = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(resource) {\n        var _this4 = this;\n        var available, using;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              available = this._availableObjects.length;\n              using = this._inUseObjects.length;\n              this._availableObjects = this._availableObjects.filter(function (object) {\n                return object.resource !== resource;\n              });\n              this._inUseObjects = this._inUseObjects.filter(function (object) {\n                return object.resource !== resource;\n              });\n              if (!(available === this._availableObjects.length && using === this._inUseObjects.length)) {\n                _context.next = 7;\n                break;\n              }\n              this._ensureMinimum();\n              return _context.abrupt(\"return\");\n            case 7:\n              this._count -= 1;\n              if (this._count < 0) this._count = 0;\n              _context.prev = 9;\n              _context.next = 12;\n              return this._factory.destroy(resource);\n            case 12:\n              _context.prev = 12;\n              this._ensureMinimum();\n              if (!this._draining) {\n                process.nextTick(function () {\n                  _this4._dispense();\n                });\n              }\n              return _context.finish(12);\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[9,, 12, 16]]);\n      }));\n      function destroy(_x) {\n        return _destroy.apply(this, arguments);\n      }\n      return destroy;\n    }()\n  }, {\n    key: \"drain\",\n    value: function drain() {\n      var _this5 = this;\n      this._log('draining', 'info');\n      this._draining = true;\n      var check = function check(callback) {\n        if (_this5._pendingAcquires.length > 0) {\n          _this5._dispense();\n          setTimeout(function () {\n            check(callback);\n          }, 100);\n          return;\n        }\n        if (_this5._availableObjects.length !== _this5._count) {\n          setTimeout(function () {\n            check(callback);\n          }, 100);\n          return;\n        }\n        callback();\n      };\n      return new Promise(function (resolve) {\n        return check(resolve);\n      });\n    }\n  }, {\n    key: \"destroyAllNow\",\n    value: function () {\n      var _destroyAllNow = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var resources, errors, _iterator, _step, resource;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              this._log('force destroying all objects', 'info');\n              this._removeIdleScheduled = false;\n              clearTimeout(this._removeIdleTimer);\n              resources = this._availableObjects.map(function (resource) {\n                return resource.resource;\n              });\n              errors = [];\n              _iterator = _createForOfIteratorHelper(resources);\n              _context2.prev = 6;\n              _iterator.s();\n            case 8:\n              if ((_step = _iterator.n()).done) {\n                _context2.next = 21;\n                break;\n              }\n              resource = _step.value;\n              _context2.prev = 10;\n              _context2.next = 13;\n              return this.destroy(resource);\n            case 13:\n              _context2.next = 19;\n              break;\n            case 15:\n              _context2.prev = 15;\n              _context2.t0 = _context2[\"catch\"](10);\n              this._log('Error destroying resource: ' + _context2.t0.stack, 'error');\n              errors.push(_context2.t0);\n            case 19:\n              _context2.next = 8;\n              break;\n            case 21:\n              _context2.next = 26;\n              break;\n            case 23:\n              _context2.prev = 23;\n              _context2.t1 = _context2[\"catch\"](6);\n              _iterator.e(_context2.t1);\n            case 26:\n              _context2.prev = 26;\n              _iterator.f();\n              return _context2.finish(26);\n            case 29:\n              if (!(errors.length > 0)) {\n                _context2.next = 31;\n                break;\n              }\n              throw new AggregateError_1.AggregateError(errors);\n            case 31:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[6, 23, 26, 29], [10, 15]]);\n      }));\n      function destroyAllNow() {\n        return _destroyAllNow.apply(this, arguments);\n      }\n      return destroyAllNow;\n    }()\n  }]);\n  return Pool;\n}();\nexports.Pool = Pool;","map":{"version":3,"names":["Deferred_1","require","AggregateError_1","Pool","factory","_classCallCheck","log","create","Error","destroy","validate","min","Math","round","max","maxUses","undefined","idleTimeoutMillis","acquireTimeoutMillis","reapIntervalMillis","maxUsesPerResource","Infinity","_factory","_count","_draining","_pendingAcquires","_inUseObjects","_availableObjects","_removeIdleScheduled","_createClass","key","get","name","length","value","_log","message","level","console","concat","toUpperCase","_removeIdle","toRemove","now","Date","i","available","maxRemovable","size","minSize","timeout","push","resource","forEach","_scheduleRemoveIdle","_this","_removeIdleTimer","setTimeout","_dispense","wrappedResource","waitingCount","pop","_addResourceToInUseObjects","useCount","deferred","shift","resolve","maxSize","_createResource","_this2","then","_addResourceToAvailableObjects","catch","error","reject","process","nextTick","_ensureMinimum","diff","acquire","_this3","Promise","Deferred","registerTimeout","filter","pending","promise","release","some","resourceWithTimeout","stack","index","findIndex","splice","_destroy","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this4","using","wrap","_callee$","_context","prev","next","object","abrupt","finish","stop","_x","apply","arguments","drain","_this5","check","callback","_destroyAllNow","_callee2","resources","errors","_iterator","_step","_callee2$","_context2","clearTimeout","map","_createForOfIteratorHelper","s","n","done","t0","t1","e","f","AggregateError","destroyAllNow","exports"],"sources":["../src/Pool.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AACA,IAAAC,gBAAA,GAAAD,OAAA;AAAkD,IAqGrCE,IAAI;EAuBf,SAAAA,KAAYC,OAAoC;IAAAC,eAAA,OAAAF,IAAA;IAftC,KAAAG,GAAG,GAA4B,KAAK;IAgB5C,IAAI,CAACF,OAAO,CAACG,MAAM,EAAE;MACnB,MAAM,IAAIC,KAAK,CAAC,6BAA6B,CAAC;;IAGhD,IAAI,CAACJ,OAAO,CAACK,OAAO,EAAE;MACpB,MAAM,IAAID,KAAK,CAAC,8BAA8B,CAAC;;IAGjD,IAAI,CAACJ,OAAO,CAACM,QAAQ,EAAE;MACrB,MAAM,IAAIF,KAAK,CAAC,+BAA+B,CAAC;;IAGlD,IACE,OAAOJ,OAAO,CAACO,GAAG,KAAK,QAAQ,IAC/BP,OAAO,CAACO,GAAG,GAAG,CAAC,IACfP,OAAO,CAACO,GAAG,KAAKC,IAAI,CAACC,KAAK,CAACT,OAAO,CAACO,GAAG,CAAC,EACvC;MACA,MAAM,IAAIH,KAAK,CAAC,6BAA6B,CAAC;;IAGhD,IACE,OAAOJ,OAAO,CAACU,GAAG,KAAK,QAAQ,IAC/BV,OAAO,CAACU,GAAG,IAAI,CAAC,IAChBV,OAAO,CAACU,GAAG,KAAKF,IAAI,CAACC,KAAK,CAACT,OAAO,CAACU,GAAG,CAAC,EACvC;MACA,MAAM,IAAIN,KAAK,CAAC,4BAA4B,CAAC;;IAG/C,IAAIJ,OAAO,CAACO,GAAG,GAAGP,OAAO,CAACU,GAAG,EAAE;MAC7B,MAAM,IAAIN,KAAK,CAAC,yBAAyB,CAAC;;IAG5C,IACEJ,OAAO,CAACW,OAAO,KAAKC,SAAS,KAC5B,OAAOZ,OAAO,CAACW,OAAO,KAAK,QAAQ,IAAIX,OAAO,CAACW,OAAO,GAAG,CAAC,CAAC,EAC5D;MACA,MAAM,IAAIP,KAAK,CAAC,iCAAiC,CAAC;;IAIpD,IAAI,CAACS,iBAAiB,GAAGb,OAAO,CAACa,iBAAiB,IAAI,KAAK;IAC3D,IAAI,CAACC,oBAAoB,GAAGd,OAAO,CAACc,oBAAoB,IAAI,KAAK;IACjE,IAAI,CAACC,kBAAkB,GAAGf,OAAO,CAACe,kBAAkB,IAAI,IAAI;IAC5D,IAAI,CAACC,kBAAkB,GAAGhB,OAAO,CAACW,OAAO,IAAIM,QAAQ;IACrD,IAAI,CAACf,GAAG,GAAGF,OAAO,CAACE,GAAG,IAAI,KAAK;IAE/B,IAAI,CAACgB,QAAQ,GAAGlB,OAAO;IACvB,IAAI,CAACmB,MAAM,GAAG,CAAC;IACf,IAAI,CAACC,SAAS,GAAG,KAAK;IAGtB,IAAI,CAACC,gBAAgB,GAAG,EAAE;IAC1B,IAAI,CAACC,aAAa,GAAG,EAAE;IACvB,IAAI,CAACC,iBAAiB,GAAG,EAAE;IAG3B,IAAI,CAACC,oBAAoB,GAAG,KAAK;EACnC;EAACC,YAAA,CAAA1B,IAAA;IAAA2B,GAAA;IAAAC,GAAA,EAMD,SAAAA,IAAA,EAAQ;MACN,OAAO,IAAI,CAACR,MAAM;IACpB;EAAC;IAAAO,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAQ;MACN,OAAO,IAAI,CAACT,QAAQ,CAACU,IAAI;IAC3B;EAAC;IAAAF,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAa;MACX,OAAO,IAAI,CAACJ,iBAAiB,CAACM,MAAM;IACtC;EAAC;IAAAH,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAS;MACP,OAAO,IAAI,CAACL,aAAa,CAACO,MAAM;IAClC;EAAC;IAAAH,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAW;MACT,OAAO,IAAI,CAACN,gBAAgB,CAACQ,MAAM;IACrC;EAAC;IAAAH,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAW;MACT,OAAO,IAAI,CAACT,QAAQ,CAACR,GAAG;IAC1B;EAAC;IAAAgB,GAAA;IAAAC,GAAA,EAKD,SAAAA,IAAA,EAAW;MACT,OAAO,IAAI,CAACT,QAAQ,CAACX,GAAG;IAC1B;EAAC;IAAAmB,GAAA;IAAAI,KAAA,EAKS,SAAAC,KAAKC,OAAe,EAAEC,KAAe;MAC7C,IAAI,OAAO,IAAI,CAAC/B,GAAG,KAAK,UAAU,EAAE;QAClC,IAAI,CAACA,GAAG,CAAC8B,OAAO,EAAEC,KAAK,CAAC;OACzB,MAAM,IAAI,IAAI,CAAC/B,GAAG,EAAE;QACnBgC,OAAO,CAAChC,GAAG,IAAAiC,MAAA,CACNF,KAAK,CAACG,WAAW,EAAE,YAAAD,MAAA,CAAS,IAAI,CAACP,IAAI,IAAI,EAAE,SAAAO,MAAA,CAAMH,OAAO,CAAE,CAC9D;;IAEL;EAAC;IAAAN,GAAA;IAAAI,KAAA,EAKS,SAAAO,YAAA,EAAW;MACnB,IAAMC,QAAQ,GAAG,EAAE;MACnB,IAAMC,GAAG,GAAGC,IAAI,CAACD,GAAG,EAAE;MACtB,IAAIE,CAAC;MACL,IAAIC,SAAS,GAAG,IAAI,CAACnB,iBAAiB,CAACM,MAAM;MAC7C,IAAMc,YAAY,GAAG,IAAI,CAACC,IAAI,GAAG,IAAI,CAACC,OAAO;MAC7C,IAAIC,OAAO;MAEX,IAAI,CAACtB,oBAAoB,GAAG,KAAK;MAIjC,KAAKiB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,IAAIC,YAAY,GAAGL,QAAQ,CAACT,MAAM,EAAEY,CAAC,EAAE,EAAE;QAChEK,OAAO,GAAG,IAAI,CAACvB,iBAAiB,CAACkB,CAAC,CAAC,CAACK,OAAO;QAC3C,IAAIP,GAAG,IAAIO,OAAO,EAAE;UAElB,IAAI,CAACf,IAAI,CACP,oCAAoC,GAAGQ,GAAG,GAAG,WAAW,GAAGO,OAAO,EAClE,SAAS,CACV;UACDR,QAAQ,CAACS,IAAI,CAAC,IAAI,CAACxB,iBAAiB,CAACkB,CAAC,CAAC,CAACO,QAAQ,CAAC;;;MAIrDV,QAAQ,CAACW,OAAO,CAAC,IAAI,CAAC5C,OAAO,EAAE,IAAI,CAAC;MAKpCqC,SAAS,GAAG,IAAI,CAACnB,iBAAiB,CAACM,MAAM;MAEzC,IAAIa,SAAS,GAAG,CAAC,EAAE;QACjB,IAAI,CAACX,IAAI,CAAC,gCAAgC,GAAGW,SAAS,EAAE,SAAS,CAAC;QAClE,IAAI,CAACQ,mBAAmB,EAAE;OAC3B,MAAM;QACL,IAAI,CAACnB,IAAI,CAAC,kCAAkC,EAAE,SAAS,CAAC;;IAE5D;EAAC;IAAAL,GAAA;IAAAI,KAAA,EAMS,SAAAoB,oBAAA,EAAmB;MAAA,IAAAC,KAAA;MAC3B,IAAI,CAAC,IAAI,CAAC3B,oBAAoB,EAAE;QAC9B,IAAI,CAACA,oBAAoB,GAAG,IAAI;QAChC,IAAI,CAAC4B,gBAAgB,GAAGC,UAAU,CAAC,YAAK;UACtCF,KAAI,CAACd,WAAW,EAAE;QACpB,CAAC,EAAE,IAAI,CAACtB,kBAAkB,CAAC;;IAE/B;EAAC;IAAAW,GAAA;IAAAI,KAAA,EAYS,SAAAwB,UAAA,EAAS;MACjB,IAAIC,eAAe,GAAG,IAAI;MAC1B,IAAMC,YAAY,GAAG,IAAI,CAACnC,gBAAgB,CAACQ,MAAM;MAEjD,IAAI,CAACE,IAAI,uBAAAI,MAAA,CACeqB,YAAY,iBAAArB,MAAA,CAAc,IAAI,CAACZ,iBAAiB,CAACM,MAAM,GAC7E,MAAM,CACP;MAED,IAAI2B,YAAY,GAAG,CAAC,EAAE;QACpB;;MAGF,OAAO,IAAI,CAACjC,iBAAiB,CAACM,MAAM,GAAG,CAAC,EAAE;QACxC,IAAI,CAACE,IAAI,CAAC,0BAA0B,EAAE,SAAS,CAAC;QAChDwB,eAAe,GAAG,IAAI,CAAChC,iBAAiB,CACtC,IAAI,CAACA,iBAAiB,CAACM,MAAM,GAAG,CAAC,CAClC;QACD,IAAI,CAAC,IAAI,CAACX,QAAQ,CAACZ,QAAQ,CAACiD,eAAe,CAACP,QAAQ,CAAC,EAAE;UACrD,IAAI,CAAC3C,OAAO,CAACkD,eAAe,CAACP,QAAQ,CAAC;UACtC;;QAGF,IAAI,CAACzB,iBAAiB,CAACkC,GAAG,EAAE;QAC5B,IAAI,CAACC,0BAA0B,CAC7BH,eAAe,CAACP,QAAQ,EACxBO,eAAe,CAACI,QAAQ,CACzB;QAED,IAAMC,QAAQ,GAAG,IAAI,CAACvC,gBAAgB,CAACwC,KAAK,EAAE;QAC9C,OAAOD,QAAQ,CAACE,OAAO,CAACP,eAAe,CAACP,QAAQ,CAAC;;MAGnD,IAAI,IAAI,CAACJ,IAAI,GAAG,IAAI,CAACmB,OAAO,EAAE;QAC5B,IAAI,CAACC,eAAe,EAAE;;IAE1B;EAAC;IAAAtC,GAAA;IAAAI,KAAA,EAES,SAAAkC,gBAAA,EAAe;MAAA,IAAAC,MAAA;MACvB,IAAI,CAAC9C,MAAM,IAAI,CAAC;MAChB,IAAI,CAACY,IAAI,4CAAAI,MAAA,CACoC,IAAI,CAACS,IAAI,WAAAT,MAAA,CAAQ,IAAI,CAACU,OAAO,WAAAV,MAAA,CAAQ,IAAI,CAAC4B,OAAO,GAC5F,SAAS,CACV;MAED,IAAI,CAAC7C,QAAQ,CACVf,MAAM,EAAE,CACR+D,IAAI,CAAC,UAAClB,QAAQ,EAAI;QACjB,IAAMY,QAAQ,GAAGK,MAAI,CAAC5C,gBAAgB,CAACwC,KAAK,EAAE;QAE9C,IAAID,QAAQ,EAAE;UACZK,MAAI,CAACP,0BAA0B,CAACV,QAAQ,EAAE,CAAC,CAAC;UAC5CY,QAAQ,CAACE,OAAO,CAACd,QAAQ,CAAC;SAC3B,MAAM;UACLiB,MAAI,CAACE,8BAA8B,CAACnB,QAAQ,EAAE,CAAC,CAAC;;MAEpD,CAAC,CAAC,CACDoB,KAAK,CAAC,UAACC,KAAK,EAAI;QACf,IAAMT,QAAQ,GAAGK,MAAI,CAAC5C,gBAAgB,CAACwC,KAAK,EAAE;QAE9CI,MAAI,CAAC9C,MAAM,IAAI,CAAC;QAChB,IAAI8C,MAAI,CAAC9C,MAAM,GAAG,CAAC,EAAE8C,MAAI,CAAC9C,MAAM,GAAG,CAAC;QACpC,IAAIyC,QAAQ,EAAE;UACZA,QAAQ,CAACU,MAAM,CAACD,KAAK,CAAC;;QAExBE,OAAO,CAACC,QAAQ,CAAC,YAAK;UACpBP,MAAI,CAACX,SAAS,EAAE;QAClB,CAAC,CAAC;MACJ,CAAC,CAAC;IACN;EAAC;IAAA5B,GAAA;IAAAI,KAAA,EAES,SAAAqC,+BACRnB,QAAqB,EACrBW,QAAgB;MAEhB,IAAMJ,eAAe,GAAG;QACtBP,QAAQ,EAAEA,QAAQ;QAClBW,QAAQ,EAAEA,QAAQ;QAClBb,OAAO,EAAEN,IAAI,CAACD,GAAG,EAAE,GAAG,IAAI,CAAC1B;OAC5B;MAED,IAAI,CAACU,iBAAiB,CAACwB,IAAI,CAACQ,eAAe,CAAC;MAC5C,IAAI,CAACD,SAAS,EAAE;MAChB,IAAI,CAACJ,mBAAmB,EAAE;IAC5B;EAAC;IAAAxB,GAAA;IAAAI,KAAA,EAES,SAAA4B,2BACRV,QAAqB,EACrBW,QAAgB;MAEhB,IAAMJ,eAAe,GAAG;QACtBP,QAAQ,EAAEA,QAAQ;QAClBW,QAAQ,EAAEA;OACX;MACD,IAAI,CAACrC,aAAa,CAACyB,IAAI,CAACQ,eAAe,CAAC;IAC1C;EAAC;IAAA7B,GAAA;IAAAI,KAAA,EAES,SAAA2C,eAAA,EAAc;MACtB,IAAIhC,CAAC,EAAEiC,IAAI;MACX,IAAI,CAAC,IAAI,CAACtD,SAAS,IAAI,IAAI,CAACwB,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;QAC/C6B,IAAI,GAAG,IAAI,CAAC7B,OAAO,GAAG,IAAI,CAACD,IAAI;QAC/B,KAAKH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiC,IAAI,EAAEjC,CAAC,EAAE,EAAE;UACzB,IAAI,CAACuB,eAAe,EAAE;;;IAG5B;EAAC;IAAAtC,GAAA;IAAAI,KAAA,EAUD,SAAA6C,QAAA,EAAO;MAAA,IAAAC,MAAA;MACL,IAAI,IAAI,CAACxD,SAAS,EAAE;QAClB,OAAOyD,OAAO,CAACP,MAAM,CACnB,IAAIlE,KAAK,CAAC,yCAAyC,CAAC,CACrD;;MAGH,IAAMwD,QAAQ,GAAG,IAAIhE,UAAA,CAAAkF,QAAQ,EAAe;MAC5ClB,QAAQ,CAACmB,eAAe,CAAC,IAAI,CAACjE,oBAAoB,EAAE,YAAK;QAGvD8D,MAAI,CAACvD,gBAAgB,GAAGuD,MAAI,CAACvD,gBAAgB,CAAC2D,MAAM,CAClD,UAACC,OAAO;UAAA,OAAKA,OAAO,KAAKrB,QAAQ;QAAA,EAClC;MACH,CAAC,CAAC;MAEF,IAAI,CAACvC,gBAAgB,CAAC0B,IAAI,CAACa,QAAQ,CAAC;MACpC,IAAI,CAACN,SAAS,EAAE;MAEhB,OAAOM,QAAQ,CAACsB,OAAO,EAAE;IAC3B;EAAC;IAAAxD,GAAA;IAAAI,KAAA,EAMD,SAAAqD,QAAQnC,QAAqB;MAG3B,IACE,IAAI,CAACzB,iBAAiB,CAAC6D,IAAI,CACzB,UAACC,mBAAmB;QAAA,OAAKA,mBAAmB,CAACrC,QAAQ,KAAKA,QAAQ;MAAA,EACnE,EACD;QACA,IAAI,CAACjB,IAAI,CACP,8CAA8C,GAAG,IAAI3B,KAAK,EAAE,CAACkF,KAAK,EAClE,OAAO,CACR;QACD;;MAIF,IAAMC,KAAK,GAAG,IAAI,CAACjE,aAAa,CAACkE,SAAS,CACxC,UAACjC,eAAe;QAAA,OAAKA,eAAe,CAACP,QAAQ,KAAKA,QAAQ;MAAA,EAC3D;MACD,IAAIuC,KAAK,GAAG,CAAC,EAAE;QACb,IAAI,CAACxD,IAAI,CACP,0CAA0C,GAAG,IAAI3B,KAAK,EAAE,CAACkF,KAAK,EAC9D,OAAO,CACR;QACD;;MAEF,IAAM/B,eAAe,GAAG,IAAI,CAACjC,aAAa,CAACiE,KAAK,CAAC;MAGjDhC,eAAe,CAACI,QAAQ,IAAI,CAAC;MAC7B,IAAIJ,eAAe,CAACI,QAAQ,IAAI,IAAI,CAAC3C,kBAAkB,EAAE;QAEvD,IAAI,CAACe,IAAI,CACP,sCAAsC,GACpCwB,eAAe,CAACI,QAAQ,GACxB,sBAAsB,GACtB,IAAI,CAAC3C,kBAAkB,EACzB,SAAS,CACV;QACD,IAAI,CAACX,OAAO,CAACkD,eAAe,CAACP,QAAQ,CAAC;QAItC,IAAI,CAACM,SAAS,EAAE;OACjB,MAAM;QAEL,IAAI,CAAChC,aAAa,CAACmE,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;QACnC,IAAI,CAACpB,8BAA8B,CACjCZ,eAAe,CAACP,QAAQ,EACxBO,eAAe,CAACI,QAAQ,CACzB;;IAEL;EAAC;IAAAjC,GAAA;IAAAI,KAAA;MAAA,IAAA4D,QAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAOD,SAAAC,QAAc9C,QAAqB;QAAA,IAAA+C,MAAA;QAAA,IAAArD,SAAA,EAAAsD,KAAA;QAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAC3B3D,SAAS,GAAG,IAAI,CAACnB,iBAAiB,CAACM,MAAM;cACzCmE,KAAK,GAAG,IAAI,CAAC1E,aAAa,CAACO,MAAM;cAEvC,IAAI,CAACN,iBAAiB,GAAG,IAAI,CAACA,iBAAiB,CAACyD,MAAM,CACpD,UAACsB,MAAM;gBAAA,OAAKA,MAAM,CAACtD,QAAQ,KAAKA,QAAQ;cAAA,EACzC;cACD,IAAI,CAAC1B,aAAa,GAAG,IAAI,CAACA,aAAa,CAAC0D,MAAM,CAC5C,UAACsB,MAAM;gBAAA,OAAKA,MAAM,CAACtD,QAAQ,KAAKA,QAAQ;cAAA,EACzC;cAAC,MAIAN,SAAS,KAAK,IAAI,CAACnB,iBAAiB,CAACM,MAAM,IAC3CmE,KAAK,KAAK,IAAI,CAAC1E,aAAa,CAACO,MAAM;gBAAAsE,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAEnC,IAAI,CAAC5B,cAAc,EAAE;cAAC,OAAA0B,QAAA,CAAAI,MAAA;YAAA;cAIxB,IAAI,CAACpF,MAAM,IAAI,CAAC;cAChB,IAAI,IAAI,CAACA,MAAM,GAAG,CAAC,EAAE,IAAI,CAACA,MAAM,GAAG,CAAC;cAACgF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAG7B,IAAI,CAACnF,QAAQ,CAACb,OAAO,CAAC2C,QAAQ,CAAC;YAAA;cAAAmD,QAAA,CAAAC,IAAA;cAErC,IAAI,CAAC3B,cAAc,EAAE;cAIrB,IAAI,CAAC,IAAI,CAACrD,SAAS,EAAE;gBACnBmD,OAAO,CAACC,QAAQ,CAAC,YAAK;kBACpBuB,MAAI,CAACzC,SAAS,EAAE;gBAClB,CAAC,CAAC;;cACH,OAAA6C,QAAA,CAAAK,MAAA;YAAA;YAAA;cAAA,OAAAL,QAAA,CAAAM,IAAA;UAAA;QAAA,GAAAX,OAAA;MAAA,CAEJ;MAAA,SAAAzF,QAAAqG,EAAA;QAAA,OAAAhB,QAAA,CAAAiB,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAvG,OAAA;IAAA;EAAA;IAAAqB,GAAA;IAAAI,KAAA,EAKD,SAAA+E,MAAA,EAAK;MAAA,IAAAC,MAAA;MACH,IAAI,CAAC/E,IAAI,CAAC,UAAU,EAAE,MAAM,CAAC;MAG7B,IAAI,CAACX,SAAS,GAAG,IAAI;MAErB,IAAM2F,KAAK,GAAG,SAARA,KAAKA,CAAIC,QAAkB,EAAU;QAEzC,IAAIF,MAAI,CAACzF,gBAAgB,CAACQ,MAAM,GAAG,CAAC,EAAE;UAGpCiF,MAAI,CAACxD,SAAS,EAAE;UAChBD,UAAU,CAAC,YAAK;YACd0D,KAAK,CAACC,QAAQ,CAAC;UACjB,CAAC,EAAE,GAAG,CAAC;UACP;;QAIF,IAAIF,MAAI,CAACvF,iBAAiB,CAACM,MAAM,KAAKiF,MAAI,CAAC3F,MAAM,EAAE;UACjDkC,UAAU,CAAC,YAAK;YACd0D,KAAK,CAACC,QAAQ,CAAC;UACjB,CAAC,EAAE,GAAG,CAAC;UACP;;QAGFA,QAAQ,EAAE;MACZ,CAAC;MAED,OAAO,IAAInC,OAAO,CAAC,UAACf,OAAO;QAAA,OAAKiD,KAAK,CAACjD,OAAO,CAAC;MAAA,EAAC;IACjD;EAAC;IAAApC,GAAA;IAAAI,KAAA;MAAA,IAAAmF,cAAA,GAAAtB,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAcD,SAAAqB,SAAA;QAAA,IAAAC,SAAA,EAAAC,MAAA,EAAAC,SAAA,EAAAC,KAAA,EAAAtE,QAAA;QAAA,OAAA4C,mBAAA,GAAAK,IAAA,UAAAsB,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAApB,IAAA,GAAAoB,SAAA,CAAAnB,IAAA;YAAA;cACE,IAAI,CAACtE,IAAI,CAAC,8BAA8B,EAAE,MAAM,CAAC;cAEjD,IAAI,CAACP,oBAAoB,GAAG,KAAK;cACjCiG,YAAY,CAAC,IAAI,CAACrE,gBAAgB,CAAC;cAE7B+D,SAAS,GAAG,IAAI,CAAC5F,iBAAiB,CAACmG,GAAG,CAC1C,UAAC1E,QAAQ;gBAAA,OAAKA,QAAQ,CAACA,QAAQ;cAAA,EAChC;cACKoE,MAAM,GAAG,EAAE;cAAAC,SAAA,GAAAM,0BAAA,CACMR,SAAS;cAAAK,SAAA,CAAApB,IAAA;cAAAiB,SAAA,CAAAO,CAAA;YAAA;cAAA,KAAAN,KAAA,GAAAD,SAAA,CAAAQ,CAAA,IAAAC,IAAA;gBAAAN,SAAA,CAAAnB,IAAA;gBAAA;cAAA;cAArBrD,QAAQ,GAAAsE,KAAA,CAAAxF,KAAA;cAAA0F,SAAA,CAAApB,IAAA;cAAAoB,SAAA,CAAAnB,IAAA;cAAA,OAET,IAAI,CAAChG,OAAO,CAAC2C,QAAQ,CAAC;YAAA;cAAAwE,SAAA,CAAAnB,IAAA;cAAA;YAAA;cAAAmB,SAAA,CAAApB,IAAA;cAAAoB,SAAA,CAAAO,EAAA,GAAAP,SAAA;cAE5B,IAAI,CAACzF,IAAI,CAAC,6BAA6B,GAAGyF,SAAA,CAAAO,EAAA,CAAGzC,KAAK,EAAE,OAAO,CAAC;cAC5D8B,MAAM,CAACrE,IAAI,CAAAyE,SAAA,CAAAO,EAAG,CAAC;YAAC;cAAAP,SAAA,CAAAnB,IAAA;cAAA;YAAA;cAAAmB,SAAA,CAAAnB,IAAA;cAAA;YAAA;cAAAmB,SAAA,CAAApB,IAAA;cAAAoB,SAAA,CAAAQ,EAAA,GAAAR,SAAA;cAAAH,SAAA,CAAAY,CAAA,CAAAT,SAAA,CAAAQ,EAAA;YAAA;cAAAR,SAAA,CAAApB,IAAA;cAAAiB,SAAA,CAAAa,CAAA;cAAA,OAAAV,SAAA,CAAAhB,MAAA;YAAA;cAAA,MAIhBY,MAAM,CAACvF,MAAM,GAAG,CAAC;gBAAA2F,SAAA,CAAAnB,IAAA;gBAAA;cAAA;cAAA,MACb,IAAIvG,gBAAA,CAAAqI,cAAc,CAACf,MAAM,CAAC;YAAA;YAAA;cAAA,OAAAI,SAAA,CAAAf,IAAA;UAAA;QAAA,GAAAS,QAAA;MAAA,CAEnC;MAAA,SAAAkB,cAAA;QAAA,OAAAnB,cAAA,CAAAN,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAwB,aAAA;IAAA;EAAA;EAAA,OAAArI,IAAA;AAAA;AAtgBHsI,OAAA,CAAAtI,IAAA,GAAAA,IAAA"},"metadata":{},"sourceType":"script"}