{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/aribraun/Desktop/db-import/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _decimaln = _interopRequireDefault(require(\"./decimaln\"));\nvar _writableTrackingBuffer = _interopRequireDefault(require(\"../tracking-buffer/writable-tracking-buffer\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar NULL_LENGTH = Buffer.from([0x00]);\nvar Decimal = {\n  id: 0x37,\n  type: 'DECIMAL',\n  name: 'Decimal',\n  declaration: function declaration(parameter) {\n    return 'decimal(' + this.resolvePrecision(parameter) + ', ' + this.resolveScale(parameter) + ')';\n  },\n  resolvePrecision: function resolvePrecision(parameter) {\n    if (parameter.precision != null) {\n      return parameter.precision;\n    } else if (parameter.value === null) {\n      return 1;\n    } else {\n      return 18;\n    }\n  },\n  resolveScale: function resolveScale(parameter) {\n    if (parameter.scale != null) {\n      return parameter.scale;\n    } else {\n      return 0;\n    }\n  },\n  generateTypeInfo: function generateTypeInfo(parameter, _options) {\n    var precision;\n    if (parameter.precision <= 9) {\n      precision = 0x05;\n    } else if (parameter.precision <= 19) {\n      precision = 0x09;\n    } else if (parameter.precision <= 28) {\n      precision = 0x0D;\n    } else {\n      precision = 0x11;\n    }\n    return Buffer.from([_decimaln.default.id, precision, parameter.precision, parameter.scale]);\n  },\n  generateParameterLength: function generateParameterLength(parameter, options) {\n    if (parameter.value == null) {\n      return NULL_LENGTH;\n    }\n    var precision = parameter.precision;\n    if (precision <= 9) {\n      return Buffer.from([0x05]);\n    } else if (precision <= 19) {\n      return Buffer.from([0x09]);\n    } else if (precision <= 28) {\n      return Buffer.from([0x0D]);\n    } else {\n      return Buffer.from([0x11]);\n    }\n  },\n  generateParameterData: /*#__PURE__*/_regeneratorRuntime().mark(function generateParameterData(parameter, options) {\n    var sign, value, precision, buffer, _buffer, _buffer2, _buffer3;\n    return _regeneratorRuntime().wrap(function generateParameterData$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!(parameter.value == null)) {\n            _context.next = 2;\n            break;\n          }\n          return _context.abrupt(\"return\");\n        case 2:\n          sign = parameter.value < 0 ? 0 : 1;\n          value = Math.round(Math.abs(parameter.value * Math.pow(10, parameter.scale)));\n          precision = parameter.precision;\n          if (!(precision <= 9)) {\n            _context.next = 13;\n            break;\n          }\n          buffer = Buffer.alloc(5);\n          buffer.writeUInt8(sign, 0);\n          buffer.writeUInt32LE(value, 1);\n          _context.next = 11;\n          return buffer;\n        case 11:\n          _context.next = 37;\n          break;\n        case 13:\n          if (!(precision <= 19)) {\n            _context.next = 21;\n            break;\n          }\n          _buffer = new _writableTrackingBuffer.default(9);\n          _buffer.writeUInt8(sign);\n          _buffer.writeUInt64LE(value);\n          _context.next = 19;\n          return _buffer.data;\n        case 19:\n          _context.next = 37;\n          break;\n        case 21:\n          if (!(precision <= 28)) {\n            _context.next = 30;\n            break;\n          }\n          _buffer2 = new _writableTrackingBuffer.default(13);\n          _buffer2.writeUInt8(sign);\n          _buffer2.writeUInt64LE(value);\n          _buffer2.writeUInt32LE(0x00000000);\n          _context.next = 28;\n          return _buffer2.data;\n        case 28:\n          _context.next = 37;\n          break;\n        case 30:\n          _buffer3 = new _writableTrackingBuffer.default(17);\n          _buffer3.writeUInt8(sign);\n          _buffer3.writeUInt64LE(value);\n          _buffer3.writeUInt32LE(0x00000000);\n          _buffer3.writeUInt32LE(0x00000000);\n          _context.next = 37;\n          return _buffer3.data;\n        case 37:\n        case \"end\":\n          return _context.stop();\n      }\n    }, generateParameterData);\n  }),\n  validate: function validate(value) {\n    if (value == null) {\n      return null;\n    }\n    value = parseFloat(value);\n    if (isNaN(value)) {\n      throw new TypeError('Invalid number.');\n    }\n    return value;\n  }\n};\nvar _default = Decimal;\nexports.default = _default;\nmodule.exports = Decimal;","map":{"version":3,"names":["_decimaln","_interopRequireDefault","require","_writableTrackingBuffer","NULL_LENGTH","Buffer","from","Decimal","id","type","name","declaration","parameter","resolvePrecision","resolveScale","precision","value","scale","generateTypeInfo","_options","default","generateParameterLength","options","generateParameterData","_regeneratorRuntime","mark","sign","buffer","_buffer","_buffer2","_buffer3","wrap","generateParameterData$","_context","prev","next","abrupt","Math","round","abs","pow","alloc","writeUInt8","writeUInt32LE","writeUInt64LE","data","stop","validate","parseFloat","isNaN","TypeError","module","exports"],"sources":["../../src/data-types/decimal.ts"],"sourcesContent":["import { DataType } from '../data-type';\nimport DecimalN from './decimaln';\nimport WritableTrackingBuffer from '../tracking-buffer/writable-tracking-buffer';\n\nconst NULL_LENGTH = Buffer.from([0x00]);\n\nconst Decimal: DataType & { resolvePrecision: NonNullable<DataType['resolvePrecision']>, resolveScale: NonNullable<DataType['resolveScale']> } = {\n  id: 0x37,\n  type: 'DECIMAL',\n  name: 'Decimal',\n\n  declaration: function(parameter) {\n    return 'decimal(' + (this.resolvePrecision(parameter)) + ', ' + (this.resolveScale(parameter)) + ')';\n  },\n\n  resolvePrecision: function(parameter) {\n    if (parameter.precision != null) {\n      return parameter.precision;\n    } else if (parameter.value === null) {\n      return 1;\n    } else {\n      return 18;\n    }\n  },\n\n  resolveScale: function(parameter) {\n    if (parameter.scale != null) {\n      return parameter.scale;\n    } else {\n      return 0;\n    }\n  },\n\n  generateTypeInfo(parameter, _options) {\n    let precision;\n    if (parameter.precision! <= 9) {\n      precision = 0x05;\n    } else if (parameter.precision! <= 19) {\n      precision = 0x09;\n    } else if (parameter.precision! <= 28) {\n      precision = 0x0D;\n    } else {\n      precision = 0x11;\n    }\n\n    return Buffer.from([DecimalN.id, precision, parameter.precision!, parameter.scale!]);\n  },\n\n  generateParameterLength(parameter, options) {\n    if (parameter.value == null) {\n      return NULL_LENGTH;\n    }\n\n    const precision = parameter.precision!;\n    if (precision <= 9) {\n      return Buffer.from([0x05]);\n    } else if (precision <= 19) {\n      return Buffer.from([0x09]);\n    } else if (precision <= 28) {\n      return Buffer.from([0x0D]);\n    } else {\n      return Buffer.from([0x11]);\n    }\n  },\n\n  * generateParameterData(parameter, options) {\n    if (parameter.value == null) {\n      return;\n    }\n\n    const sign = parameter.value < 0 ? 0 : 1;\n    const value = Math.round(Math.abs(parameter.value * Math.pow(10, parameter.scale!)));\n    const precision = parameter.precision!;\n    if (precision <= 9) {\n      const buffer = Buffer.alloc(5);\n      buffer.writeUInt8(sign, 0);\n      buffer.writeUInt32LE(value, 1);\n      yield buffer;\n    } else if (precision <= 19) {\n      const buffer = new WritableTrackingBuffer(9);\n      buffer.writeUInt8(sign);\n      buffer.writeUInt64LE(value);\n      yield buffer.data;\n    } else if (precision <= 28) {\n      const buffer = new WritableTrackingBuffer(13);\n      buffer.writeUInt8(sign);\n      buffer.writeUInt64LE(value);\n      buffer.writeUInt32LE(0x00000000);\n      yield buffer.data;\n    } else {\n      const buffer = new WritableTrackingBuffer(17);\n      buffer.writeUInt8(sign);\n      buffer.writeUInt64LE(value);\n      buffer.writeUInt32LE(0x00000000);\n      buffer.writeUInt32LE(0x00000000);\n      yield buffer.data;\n    }\n  },\n\n  validate: function(value): number | null {\n    if (value == null) {\n      return null;\n    }\n    value = parseFloat(value);\n    if (isNaN(value)) {\n      throw new TypeError('Invalid number.');\n    }\n    return value;\n  }\n};\n\nexport default Decimal;\nmodule.exports = Decimal;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}